<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OraNutrition - Internal Process & Client Insight Board (PRD v7)</title>
    <link rel="icon" href="data:,">

    <!-- Dependencies -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Configuration -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        ora: {
                            primary: '#2A9D8F',  // Teal
                            dark: '#264653',     // Dark Blue
                            light: '#E9F5F5',    // Light BG
                            warning: '#E9C46A',  // Yellow
                            danger: '#E76F51',   // Red/Orange
                            accent: '#F4A261'    // Sandy
                        }
                    },
                    fontSize: {
                        'xxs': '0.65rem'
                    }
                }
            }
        }

        // PRD 5.1 Configuration Simulation
        const CONFIG = {
            slas: { stage1: 3, stage2: 14, stage3: 5 },
            blockers: { money_grace: 7, mat_buffer: 21, silent: 14 },
            zombie: { contract: 45, inventory: 7 },
            cooling: { vol_ratio: 0.6 }
        };

        // i18n Script
        const i18nData = {
            en: {
                pageTitle: "OraNutrition Process & Client Insight Board",
                lastUpdate: "Last Update: 2024-11-28 09:00 AM",
                kpi1Title: "Lead Time Breach",
                kpi2Title: "Payment Blocked",
                kpi3Title: "Material Risk",
                kpi4Title: "Data Issues",
                part1Title: "Part 1. Internal Exception Radar",
                part2Title: "Part 2. Process Lead Time"
            },
            zh: {
                pageTitle: "OraNutrition ÂÜÖÈÉ®ÊµÅÁ®ã‰∏éÂÆ¢Êà∑Ê¥ûÂØüÊÄªËßà",
                lastUpdate: "‰∏äÊ¨°Êõ¥Êñ∞: 2024-11-28 09:00 AM",
                kpi1Title: "Êï¥‰ΩìÂë®ÊúüË∂ÖÂá∫ÂÜÖÈÉ®ÁõÆÊ†á",
                kpi2Title: "Êî∂Ê¨æÁéØËäÇÊúâÈòªÂ°û",
                kpi3Title: "Áâ©ÊñôÂáÜÂ§áÂ≠òÂú®È£éÈô©",
                kpi4Title: "Êï∞ÊçÆËÆ∞ÂΩïÈúÄË°•ÂÖÖ",
                part1Title: "Part 1. ÂÜÖÈÉ®ÂºÇÂ∏∏Èõ∑Ëææ (Internal Exception Radar)",
                part2Title: "Part 2. ÂÜÖÈÉ®ÊµÅÁ®ãÂë®Êúü (Process Lead Time)"
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const lang = urlParams.get('lang') || 'en'; // Default to English as per requirements

            const t = i18nData[lang] || i18nData['en'];

            // Helper to safely set text
            const setText = (id, text) => {
                const el = document.getElementById(id);
                if (el) el.innerText = text;
            };

            setText('header-title', t.pageTitle);
            setText('header-update', t.lastUpdate);
            setText('kpi-1-title', t.kpi1Title);
            setText('kpi-2-title', t.kpi2Title);
            setText('kpi-3-title', t.kpi3Title);
            setText('kpi-4-title', t.kpi4Title);

            // For Part Titles which are inside h2
            const part1 = document.getElementById('part-1-title');
            if (part1) part1.innerText = t.part1Title;

            const part2 = document.getElementById('part-2-title');
            if (part2) part2.innerText = t.part2Title;
        });
    </script>
    </script>

    <style>
        html {
            height: 100%;
            width: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            height: 100%;
            width: 100%;
        }

        /* Card & Layout */
        .card {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
        }

        /* Highlight Animation for Filter Interaction */
        .card.target-highlight {
            border-color: #2A9D8F;
            box-shadow: 0 0 0 4px rgba(42, 157, 143, 0.15);
            transform: scale(1.005);
            z-index: 10;
        }

        .card-header {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #f3f4f6;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: white;
            border-top-left-radius: 0.5rem;
            border-top-right-radius: 0.5rem;
        }

        .card-footer {
            padding: 0.5rem 1rem;
            border-top: 1px solid #f3f4f6;
            background-color: #f9fafb;
            color: #9ca3af;
            font-size: 0.65rem;
            border-bottom-left-radius: 0.5rem;
            border-bottom-right-radius: 0.5rem;
        }

        .card-title {
            font-weight: 700;
            color: #1f2937;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* KPI Card */
        .kpi-card {
            transition: all 0.2s ease-in-out;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .kpi-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .kpi-card.active-filter {
            border-color: #2A9D8F !important;
            background-color: #F0FDFA;
            box-shadow: inset 0 0 0 1px #2A9D8F;
        }

        .kpi-card.active-filter::after {
            content: '\f0b0';
            /* Filter Icon */
            font-family: "Font Awesome 6 Free";
            font-weight: 900;
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            color: #2A9D8F;
            opacity: 0.2;
            font-size: 2rem;
            pointer-events: none;
        }

        /* Visual Bars (Zombies/Inventory) */
        .progress-bar-bg {
            background-color: #f3f4f6;
            border-radius: 9999px;
            height: 0.5rem;
            width: 100%;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            border-radius: 9999px;
            transition: width 0.5s ease;
        }

        /* Mini Gantt in Table */
        .stage-pill {
            width: 20%;
            height: 6px;
            margin-right: 2px;
            border-radius: 2px;
            display: inline-block;
            background-color: #e5e7eb;
        }

        .stage-pill.done {
            background-color: #2A9D8F;
        }

        .stage-pill.delay {
            background-color: #E76F51;
        }

        /* Scrollbar */
        .scroller::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        .scroller::-webkit-scrollbar-thumb {
            background-color: #cbd5e1;
            border-radius: 3px;
        }

        /* Tabs */
        .tab-btn {
            transition: all 0.2s;
        }

        .tab-active {
            color: #2A9D8F;
            font-weight: 700;
            text-decoration: underline;
            text-underline-offset: 4px;
        }

        .tab-inactive {
            color: #6b7280;
            font-weight: 500;
        }

        .tab-inactive:hover {
            color: #1f2937;
        }

        /* Traffic Light Dots */
        .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
        }

        /* Desktop Scaler Wrapper */
        #desktop-scaler {
            width: 200%;
            height: 200%;
            transform: scale(0.5);
            transform-origin: top left;
            display: flex;
            flex-direction: row;
            /* Horizontal layout for Sidebar + Main */
            overflow: hidden;
            transition: all 0.3s ease;
            /* Smooth transition when maximizing */
        }

        /* Fullscreen Override Class */
        #desktop-scaler.is-fullscreen-mode {
            width: 100%;
            height: 100%;
            transform: scale(1);
        }
    </style>
    <script>
        // Auto-scale Logic
        function adjustScale() {
            const scaler = document.getElementById('desktop-scaler');
            if (window.innerWidth > 1024) { // Threshold for "Full Screen"
                scaler.classList.add('is-fullscreen-mode');
            } else {
                scaler.classList.remove('is-fullscreen-mode');
            }
        }

        window.addEventListener('resize', adjustScale);
        document.addEventListener('DOMContentLoaded', adjustScale);
    </script>
</head>

<body class="bg-gray-50 h-screen w-full overflow-hidden text-gray-800">
    <div id="desktop-scaler" class="flex h-full overflow-hidden">

        <!-- Sidebar -->
        <aside class="w-14 flex-shrink-0 flex flex-col z-20 shadow-sm transition-all bg-[#297A88]">
            <div class="h-14 flex items-center justify-center bg-white border-b border-gray-100">
                <img src="./assets/images/ora-web/slogo.png" alt="Ora" class="w-10 h-10 object-contain">
            </div>
            <nav class="flex-1 overflow-y-auto flex flex-col items-center gap-0 bg-[#297A88]">
                <!-- Dashboard (Active) -->
                <a href="#" id="nav-btn-dashboard" onclick="switchPage('dashboard'); return false;"
                    class="w-full h-14 flex items-center justify-center bg-[#066070] transition-all shadow-inner">
                    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAC0SURBVHgB7ZRBCsMgFER/y4dkkX3WHq0naY/QI+Ro3QsqgqKCtFrIoiudQOgieSBuRgf8zlyMMe9hGKiFtXaZ5/kmpXxM03Rv6VNKpJQSXC8fx7GlJ+fcd2fmLv3KlXbmNPi/ARNI/X4hhKYuxrjNwHv/LGvp0QohXrBBOWTKZnr1sAGcZAJBk8zrMFrknGkLrLUWndrud/8xqJOmHWG0rgkErmuUs+wOYAAnGa5rNMloXX8AcOJjGvOkhXMAAAAASUVORK5CYII="
                        alt="Dashboard" class="w-6 h-6">
                </a>
                <!-- Report -->
                <a href="#" id="nav-btn-contracts" onclick="switchPage('contracts'); return false;"
                    class="w-full h-14 flex items-center justify-center text-white/70 hover:bg-[#066070]/30 transition-all group">
                    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAXCAYAAAAP6L+eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHPSURBVHgBrVVZboJQFL0gzn6QOEV/KjtwB9UVtEvQHXQHxZXYrqDtClhC3QHqj3GKxCHO0nNpIGgUkyfn58HjcjjvDgciH2azmbFer22sbQqAaZoVy7Jsjh2NRo1rMbL/JhqNUiKRoEgkQvcQj8ed2FuQ+OuqqrYlSaokk0k1FoupUGLtdjsriDidTlcURaHFYmHh3e5yufwulUotL2A6nf7aIeB4PNr9fr/h8iqpVKrKF8hr53Q6dUgASMtrJpNRwfWM2w+H2H243W5/cBSdBIBC1rCo/j2PGAV7QYWfSABcl8s9jzifz3NKqhQSPGLuBCwWCQCnrUD1+SY3OWMwGOgkCOTYZI7JZOINlkwhAK1Gm83GWV0oFAKy2ax2uReKYheY4ipPMl+HopiBGr3ncjl9v99baNt6KMRQWUN+e5hcYr8B+dfDqWCl5XLZgDM+j8fjJhcRhvT5ULsxKdR5JjQcDtucZ34mrNjNKVunDz1N0/6NTESxX6lP7dn70mq1smF3NJ/PuwjoXiM6HA5UKBTq15RywTBxrWKxeEbs/OfumTj+EjbHcvVhr4FKXSiY8yaOpaOqNy0Tij1zkmU5WKkIuOJImYF2MtBab0GxfwMGnz5RbhevAAAAAElFTkSuQmCC"
                        alt="Report" class="w-6 h-6 opacity-70 group-hover:opacity-100 transition-opacity">
                </a>
                <!-- Calendar -->
                <a href="#"
                    class="w-full h-14 flex items-center justify-center text-white/70 hover:bg-[#066070]/30 transition-all group">
                    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAYCAYAAAAVibZIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAG0SURBVHgBtZXLbcJAEIZnwbyFZHGCm91BSiAduATSQToIHSQdxFRAOiAlUACSVxzgAAiDeL+c+S07OE7sSMZ80nof/j3amdlZEwWYTqfmdrt11uu1Y1nWA8UwHA4NaNHG43E7+E4JTnK5HBWLRTqdTpiqcUZZq0L7FwKP+Xz+ks1mm9weyuWyerlcaLPZ9IUQdoxdrVKpaBiwZ5K/kdx3Go2GSYvF4tVJifP57IxGo2eB+PHuXJc9txORz+cpk8lgk1LBwHeBw/BICanX65YfYyX0TqMUEDgSUVlMAtzP0B34dp9jau92uw9KSLVabSFZLnAf2LZt0Q0E7fxyn0vVWK1WPbTBYGBgjYVdzCeTSTdKEyScfUJVcaU0vWkHj0KhYHjlK6M0sUYPhwNxbH+s7fd7t+eKidTEGuWaf+Nmejtya5+LQv9PE2vUQ/N6yQ0fqXS9tWSE5ko4+7yrtn9BcBJaSTT3PfyBnfc5ISbGHC+JfrlcmlwcSJAdpQkbSf3wK7jlQalUUnGYKSGKEnAahpwU4VC9C/5rarVarceXgUY3cjweP2ez2ZPwF2CcbkTXdYn+C38a9HUI1r8wAAAAAElFTkSuQmCC"
                        alt="Calendar" class="w-6 h-6 opacity-70 group-hover:opacity-100 transition-opacity">
                </a>
            </nav>

        </aside>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col overflow-hidden relative">

            <!-- Shared Global Header (Profile Only) -->
            <header
                class="h-14 bg-white border-b border-gray-200 flex items-center justify-end px-6 flex-shrink-0 z-20 relative">
                <div class="flex items-center gap-2">
                    <div
                        class="w-8 h-8 rounded-full bg-ora-primary/20 text-ora-primary flex items-center justify-center text-xs font-bold ring-2 ring-white shadow-sm cursor-pointer hover:ring-ora-primary/50 transition">
                        JD
                    </div>
                </div>
            </header>

            <!-- PAGE: DASHBOARD -->
            <div id="page-dashboard" class="flex-1 flex flex-col overflow-hidden relative h-full">

                <!-- Header Removed -->

                <!-- Scrollable Area -->
                <div id="main-scroller" class="flex-1 overflow-y-auto bg-gray-50 p-6 scroller space-y-8 scroll-smooth">

                    <!-- Dashboard Header & Filters (Moved to Content) -->
                    <div class="mb-6">
                        <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4">
                            <div>
                                <h1 class="text-xl font-bold text-gray-900" id="header-title" data-i18n="header_title">
                                    OraNutrition ÂÜÖÈÉ®ÊµÅÁ®ã‰∏éÂÆ¢Êà∑Ê¥ûÂØüÊÄªËßà
                                </h1>
                                <p class="text-xs text-gray-500" id="header-update" data-i18n="header_update">‰∏äÊ¨°Êõ¥Êñ∞:
                                    2024-11-28 09:00 AM</p>
                            </div>

                            <div class="flex flex-wrap gap-2 items-center">
                                <!-- Date Range -->
                                <select
                                    class="text-xs border-gray-300 rounded shadow-sm focus:border-ora-primary py-1.5 px-2 bg-gray-50">
                                    <option data-i18n="filter_time_q4">üìÖ Êó∂Èó¥ËåÉÂõ¥: Êú¨Â≠£Â∫¶ (Q4)</option>
                                    <option>üìÖ 2024-06-01 ~ 2024-08-31 (Previous)</option>
                                </select>
                                <!-- Brand -->
                                <select
                                    class="text-xs border-gray-300 rounded shadow-sm focus:border-ora-primary py-1.5 px-2 bg-gray-50">
                                    <option data-i18n="filter_brand_all">ÂìÅÁâå: ÂÖ®ÈÉ®</option>
                                    <option>Little Umbrella</option>
                                    <option>PowerGums</option>
                                </select>
                                <!-- Line Category -->
                                <select
                                    class="text-xs border-gray-300 rounded shadow-sm focus:border-ora-primary py-1.5 px-2 bg-gray-50">
                                    <option data-i18n="filter_line_all">‰∫ßÁ∫øÁ±ªÂûã: ÂÖ®ÈÉ®</option>
                                    <option>Gummies</option>
                                    <option>Powder</option>
                                </select>
                                <!-- Status Filter -->
                                <button
                                    class="bg-[#297A88] text-white px-4 py-1.5 rounded text-sm hover:bg-[#066070] transition shadow-sm font-bold">
                                    <i class="fa-solid fa-rotate-right mr-1"></i> <span
                                        data-i18n="refresh_data">Âà∑Êñ∞Êï∞ÊçÆ</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- ========================================== -->
                    <!-- PART 1: INTERNAL EXCEPTION RADAR (PRD 2) -->
                    <!-- ========================================== -->
                    <section>
                        <div class="flex items-center gap-2 mb-4">
                            <h2 class="text-base font-bold text-gray-800 uppercase tracking-wide border-l-4 border-ora-primary pl-3"
                                data-i18n="p1_title">
                                Part 1. ÂÜÖÈÉ®ÂºÇÂ∏∏Èõ∑Ëææ (Internal Exception Radar)</h2>
                            <span class="text-xs text-gray-400 italic ml-2"><i
                                    class="fa-solid fa-circle-info mr-1"></i><span data-i18n="p1_subtitle">Click
                                    cards to filter details</span></span>
                        </div>

                        <!-- Widget 1A: KPI Summary Bar (PRD 2.1) -->
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                            <!-- Card 1: Lead Time Breach -->
                            <div class="card p-4 border-l-4 border-red-500 cursor-pointer hover:shadow-md transition kpi-card"
                                id="card-lead-time" onclick="toggleKpiFilterP1('card-lead-time', 'leadtime')"
                                title="Based on 142 contracts">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <div class="text-sm font-bold text-gray-700 mb-1" data-i18n="kpi_lead_title">
                                            Lead Time Breach</div>
                                        <div class="text-xs text-gray-500 uppercase font-bold" data-i18n="kpi_lead_sub">
                                            Êï¥‰ΩìÂë®ÊúüË∂ÖÂá∫ÂÜÖÈÉ®ÁõÆÊ†á</div>
                                        <div class="text-2xl font-bold text-red-600 mt-1">18 <span
                                                class="text-sm text-gray-400 font-normal">/ 142</span></div>
                                    </div>
                                    <div class="bg-red-100 p-2 rounded-full text-red-500"><i
                                            class="fa-solid fa-clock"></i>
                                    </div>
                                </div>
                                <div class="mt-2 text-xs text-red-500 font-medium"><i class="fa-solid fa-arrow-up"></i>
                                    5 vs
                                    last week</div>
                                <div class="mt-1 text-[10px] text-gray-400">Stage SLA > ÁõÆÊ†á</div>
                            </div>

                            <!-- Card 2: Payment Blocked -->
                            <div class="card p-4 border-l-4 border-orange-400 cursor-pointer hover:shadow-md transition kpi-card"
                                id="card-payment" onclick="toggleKpiFilterP1('card-payment', 'money')"
                                title="Based on 45 active contracts">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <div class="text-sm font-bold text-gray-700 mb-1" data-i18n="kpi_pay_title">
                                            Payment Blocked</div>
                                        <div class="text-xs text-gray-500 uppercase font-bold" data-i18n="kpi_pay_sub">
                                            Êî∂Ê¨æÁéØËäÇÊúâÈòªÂ°û</div>
                                        <div class="text-2xl font-bold text-orange-500 mt-1">8 <span
                                                class="text-sm text-gray-400 font-normal">Contracts</span></div>
                                    </div>
                                    <div class="bg-orange-100 p-2 rounded-full text-orange-500"><i
                                            class="fa-solid fa-hand-holding-dollar"></i></div>
                                </div>
                                <div class="mt-2 text-xs text-orange-500 font-medium">High Priority</div>
                                <div class="mt-1 text-[10px] text-gray-400">Ê¨æÈ°πÂæÖÁ°ÆËÆ§ > 3 Â§©</div>
                            </div>

                            <!-- Card 3: Material Risk -->
                            <div class="card p-4 border-l-4 border-yellow-400 cursor-pointer hover:shadow-md transition kpi-card"
                                id="card-material" onclick="toggleKpiFilterP1('card-material', 'materials')"
                                title="Based on 45 active contracts">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <div class="text-sm font-bold text-gray-700 mb-1" data-i18n="kpi_mat_title">
                                            Material Risk</div>
                                        <div class="text-xs text-gray-500 uppercase font-bold" data-i18n="kpi_mat_sub">
                                            Áâ©ÊñôÂáÜÂ§áÂ≠òÂú®È£éÈô©</div>
                                        <div class="text-2xl font-bold text-yellow-600 mt-1">12 <span
                                                class="text-sm text-gray-400 font-normal">Contracts</span></div>
                                    </div>
                                    <div class="bg-yellow-100 p-2 rounded-full text-yellow-600"><i
                                            class="fa-solid fa-boxes-stacked"></i></div>
                                </div>
                                <div class="mt-2 text-xs text-gray-500 font-medium">Requires Attention</div>
                                <div class="mt-1 text-[10px] text-gray-400">Áâ©ÊñôÊú™Âà∞+‰∏¥ËøëÊéí‰∫ß</div>
                            </div>

                            <!-- Card 4: Data Issues -->
                            <div class="card p-4 border-l-4 border-gray-400 cursor-pointer hover:shadow-md transition kpi-card"
                                id="card-data" onclick="toggleKpiFilterP1('card-data', 'data_issue')"
                                title="Based on all records">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <div class="text-sm font-bold text-gray-700 mb-1" data-i18n="kpi_data_title">
                                            Data Quality</div>
                                        <div class="text-xs text-gray-500 uppercase font-bold" data-i18n="kpi_data_sub">
                                            Êï∞ÊçÆËÆ∞ÂΩïÈúÄË°•ÂÖÖ</div>
                                        <div class="text-2xl font-bold text-gray-600 mt-1">15 <span
                                                class="text-sm text-gray-400 font-normal">Records</span></div>
                                    </div>
                                    <div class="bg-gray-100 p-2 rounded-full text-gray-600"><i
                                            class="fa-solid fa-database"></i>
                                    </div>
                                </div>
                                <div class="mt-2 text-xs text-red-500 font-medium">Affects Forecast</div>
                                <div class="mt-1 text-[10px] text-gray-400">Â≠óÊÆµÁº∫Â§±/ÂºÇÂ∏∏</div>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

                            <!-- Widget P1-B: Key Contracts Stage Overview (Merged 1B & 1C) -->
                            <div id="widget-p1b" class="card lg:col-span-2">
                                <div class="card-header">
                                    <div class="flex items-center gap-4">
                                        <h3 class="card-title"><i class="fa-solid fa-list-check text-ora-primary"></i>
                                            <span data-i18n="p1b_title">P1-B.
                                                ÂÖ≥ÈîÆËÆ¢ÂçïÈò∂ÊÆµÊÄªËßà (Key Contracts)</span>
                                        </h3>
                                        <div class="flex bg-gray-100 rounded p-0.5 space-x-1">
                                            <button onclick="switchView('p1b', 'list')" id="btn-p1b-view-list"
                                                class="px-2 py-0.5 text-xs rounded bg-white shadow-sm font-bold text-gray-800 border border-gray-200"
                                                data-i18n="btn_list">ÂàóË°®</button>
                                            <button onclick="switchView('p1b', 'graph')" id="btn-p1b-view-graph"
                                                class="px-2 py-0.5 text-xs rounded text-gray-500 hover:text-gray-800"
                                                data-i18n="btn_graph">ÂõæË°®</button>
                                        </div>
                                    </div>
                                    <!-- Internal Filters -->
                                    <div class="flex space-x-2 text-xs">
                                        <span class="text-gray-400 self-center">Filter:</span>
                                        <button onclick="filterP1B('all')" class="tab-btn tab-active" id="btn-p1b-all"
                                            data-i18n="Tab_all">ÂÖ®ÈÉ®</button>
                                        <button onclick="filterP1B('blocker')" class="tab-btn tab-inactive"
                                            id="btn-p1b-blocker" data-i18n="Tab_blocker">ÂæÖËß£ÂÜ≥ (Blocker)</button>
                                        <button onclick="filterP1B('delay')" class="tab-btn tab-inactive"
                                            id="btn-p1b-delay" data-i18n="Tab_delay">‰∏•ÈáçË∂ÖÊó∂</button>
                                    </div>
                                </div>

                                <!-- List View -->
                                <div class="p-0 overflow-x-auto flex-1" id="p1b-view-list">
                                    <table class="w-full text-left text-xs">
                                        <thead class="bg-gray-50 text-gray-500 uppercase border-b border-gray-200">
                                            <tr>
                                                <th class="px-4 py-3 font-semibold" data-i18n="th_contract">ÂêàÂêå / ÂìÅÁâå</th>
                                                <th class="px-4 py-3 font-semibold" data-i18n="th_stage">ÂΩìÂâçÈò∂ÊÆµ</th>
                                                <th class="px-4 py-3 font-semibold" data-i18n="th_delay">ÊúÄ‰∏•ÈáçÈò∂ÊÆµ (Delay)
                                                </th>
                                                <th class="px-4 py-3 font-semibold" data-i18n="th_status">Áä∂ÊÄÅ / ÂéüÂõ†</th>
                                                <th class="px-4 py-3 font-semibold text-right" data-i18n="th_time">Êó∂Èó¥
                                                    (Á≠æÁ∫¶/Êõ¥Êñ∞)</th>
                                            </tr>
                                        </thead>
                                        <tbody class="divide-y divide-gray-100" id="p1b-tbody">
                                            <!-- Mock Data: Blocker - Money -->
                                            <tr class="hover:bg-gray-50 row-blocker row-money">
                                                <td class="px-4 py-3">
                                                    <div class="font-bold text-gray-800">C2411-003</div>
                                                    <div class="text-[10px] text-gray-500">Little Umbrella</div>
                                                </td>
                                                <td class="px-4 py-3"><span
                                                        class="bg-gray-100 text-gray-600 px-2 py-0.5 rounded-full text-[10px]">S1
                                                        Ê¨æÈ°π</span></td>
                                                <td class="px-4 py-3"><span class="text-red-500 font-bold">+45d</span>
                                                </td>
                                                <td class="px-4 py-3"><span
                                                        class="bg-red-50 text-red-600 px-2 py-0.5 rounded border border-red-100 text-[10px]">Ê¨æÈ°πÊú™Âà∞</span>
                                                </td>
                                                <td class="px-4 py-3 text-right">
                                                    <div class="font-bold">45d</div>
                                                    <div class="text-[10px] text-gray-400">2d ago</div>
                                                </td>
                                            </tr>
                                            <!-- Mock Data: Blocker - Materials -->
                                            <tr class="hover:bg-gray-50 row-blocker row-materials">
                                                <td class="px-4 py-3">
                                                    <div class="font-bold text-gray-800">C2411-008</div>
                                                    <div class="text-[10px] text-gray-500">PowerGums</div>
                                                </td>
                                                <td class="px-4 py-3"><span
                                                        class="bg-gray-100 text-gray-600 px-2 py-0.5 rounded-full text-[10px]">S2
                                                        Áâ©Êñô</span></td>
                                                <td class="px-4 py-3"><span
                                                        class="text-orange-500 font-bold">+20d</span>
                                                </td>
                                                <td class="px-4 py-3"><span
                                                        class="bg-orange-50 text-orange-600 px-2 py-0.5 rounded border border-orange-100 text-[10px]">Áâ©ÊñôÊú™ÈΩê</span>
                                                </td>
                                                <td class="px-4 py-3 text-right">
                                                    <div class="font-bold">20d</div>
                                                    <div class="text-[10px] text-gray-400">1d ago</div>
                                                </td>
                                            </tr>
                                            <!-- Mock Data: SLA Breach (Lead Time) -->
                                            <tr class="hover:bg-gray-50 row-delay row-leadtime">
                                                <td class="px-4 py-3">
                                                    <div class="font-bold text-gray-800">C2410-001</div>
                                                    <div class="text-[10px] text-gray-500">Vitality</div>
                                                </td>
                                                <td class="px-4 py-3"><span
                                                        class="bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full text-[10px]">S4
                                                        Áîü‰∫ß</span></td>
                                                <td class="px-4 py-3"><span class="text-red-500 font-bold">+15d</span>
                                                </td>
                                                <td class="px-4 py-3"><span
                                                        class="text-gray-500 text-[10px]">Ë∂ÖÂá∫ÂÜÖÈÉ®ÁõÆÊ†á</span>
                                                </td>
                                                <td class="px-4 py-3 text-right">
                                                    <div class="font-bold">60d</div>
                                                    <div class="text-[10px] text-gray-400">Active</div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <div class="p-2 text-center text-xs text-gray-400 border-t border-gray-100">
                                        ÂàóË°®Êåâ‰∏•ÈáçÁ®ãÂ∫¶ÊéíÂ∫èÔºå‰ºòÂÖàÊòæÁ§∫ÂæÖËß£ÂÜ≥‰∫ãÈ°π„ÄÇ‰ªÖÂ±ïÁ§∫Ââç 20 ‰ªΩÊúÄÈúÄË¶ÅÂÖ≥Ê≥®ÁöÑËÆ¢Âçï„ÄÇ
                                    </div>
                                </div>

                                <!-- Graph View (Matrix) -->
                                <div id="p1b-view-graph" class="hidden p-4 overflow-x-auto">
                                    <div class="min-w-[500px]">
                                        <!-- Header -->
                                        <div
                                            class="grid grid-cols-6 gap-1 mb-2 text-xs font-bold text-gray-500 text-center">
                                            <div class="text-left pl-2">ÂêàÂêå</div>
                                            <div>S1 Ê¨æÈ°π</div>
                                            <div>S2 Áâ©Êñô</div>
                                            <div>S3 Á≠âÂæÖ</div>
                                            <div>S4 Áîü‰∫ß</div>
                                            <div>S5 ÂèëË¥ß</div>
                                        </div>
                                        <!-- Row 1 -->
                                        <div class="grid grid-cols-6 gap-1 mb-1 text-xs">
                                            <div class="flex flex-col justify-center pl-2">
                                                <span class="font-bold">C2411-003</span>
                                                <span class="text-[10px] text-gray-400">Little Umbrella</span>
                                            </div>
                                            <div
                                                class="bg-red-500 text-white flex flex-col items-center justify-center p-1 rounded">
                                                <span class="font-bold">+45</span>
                                                <span class="text-[8px]">Ê¨æÈ°πÊú™Âà∞</span>
                                            </div>
                                            <div class="bg-gray-100 rounded"></div>
                                            <div class="bg-gray-100 rounded"></div>
                                            <div class="bg-gray-100 rounded"></div>
                                            <div class="bg-gray-100 rounded"></div>
                                        </div>
                                        <!-- Row 2 -->
                                        <div class="grid grid-cols-6 gap-1 mb-1 text-xs">
                                            <div class="flex flex-col justify-center pl-2">
                                                <span class="font-bold">C2411-008</span>
                                                <span class="text-[10px] text-gray-400">PowerGums</span>
                                            </div>
                                            <div
                                                class="bg-green-500 text-white flex items-center justify-center rounded font-bold">
                                                OK</div>
                                            <div
                                                class="bg-orange-500 text-white flex flex-col items-center justify-center p-1 rounded">
                                                <span class="font-bold">+20</span>
                                                <span class="text-[8px]">Áâ©ÊñôÊú™ÈΩê</span>
                                            </div>
                                            <div class="bg-gray-100 rounded"></div>
                                            <div class="bg-gray-100 rounded"></div>
                                            <div class="bg-gray-100 rounded"></div>
                                        </div>
                                        <!-- Row 3 -->
                                        <div class="grid grid-cols-6 gap-1 mb-1 text-xs">
                                            <div class="flex flex-col justify-center pl-2">
                                                <span class="font-bold">C2410-001</span>
                                                <span class="text-[10px] text-gray-400">Vitality</span>
                                            </div>
                                            <div
                                                class="bg-green-500 text-white flex items-center justify-center rounded font-bold">
                                                OK</div>
                                            <div
                                                class="bg-green-500 text-white flex items-center justify-center rounded font-bold">
                                                OK</div>
                                            <div
                                                class="bg-green-500 text-white flex items-center justify-center rounded font-bold">
                                                OK</div>
                                            <div
                                                class="bg-red-400 text-white flex flex-col items-center justify-center p-1 rounded">
                                                <span class="font-bold">+15</span>
                                                <span class="text-[8px]">Áîü‰∫ßÂª∂Ëøü</span>
                                            </div>
                                            <div class="bg-gray-100 rounded"></div>
                                        </div>
                                    </div>
                                    <div class="mt-4 text-xs text-gray-400 text-center">
                                        ÂΩ©Ëâ≤Ê†ºÂ≠êË°®Á§∫ËØ•Èò∂ÊÆµÊØîÂÜÖÈÉ®ÁõÆÊ†áÂ§öÁî®ÁöÑÂ§©Êï∞„ÄÇ
                                    </div>
                                </div>
                            </div>

                            <!-- Widget P1-C: Zombie & Inventory (Renamed from 1D) -->
                            <div id="widget-p1c" class="card">
                                <div class="card-header">
                                    <h3 class="card-title"><i class="fa-solid fa-skull text-gray-500"></i> <span
                                            data-i18n="p1c_title">P1-C. ÂÉµÂ∞∏ÂêàÂêå‰∏éÂ∫ìÂ≠ò</span>
                                    </h3>
                                    <div class="flex bg-gray-100 rounded p-0.5 space-x-1">
                                        <button onclick="toggleZombieView('contracts')" id="btn-zombie-contracts"
                                            class="px-3 py-1 text-xs rounded bg-white shadow-sm font-bold text-gray-800 border border-gray-200"
                                            data-i18n="btn_zombie_contracts">ÂÅúÊªû‰∏≠ÁöÑÂêàÂêå</button>
                                        <button onclick="toggleZombieView('inventory')" id="btn-zombie-inventory"
                                            class="px-3 py-1 text-xs rounded text-gray-500 hover:text-gray-800"
                                            data-i18n="btn_zombie_inventory">ÊªûÁïôÊàêÂìÅ/ÂçäÊàêÂìÅ</button>
                                    </div>
                                </div>
                                <div class="p-4 flex-1 overflow-y-auto">
                                    <!-- View: Contracts -->
                                    <div id="view-zombie-contracts" class="space-y-3">
                                        <div class="text-xs text-gray-400 mb-2">Ë∂ÖËøá 45 Â§©Êó†Êõ¥Êñ∞ (Inactive > 45d)</div>
                                        <div class="space-y-2">
                                            <div>
                                                <div class="flex justify-between text-xs mb-1">
                                                    <span class="font-bold text-gray-700">C2408-002 (Vitality)</span>
                                                    <span class="text-red-500 font-bold">120d</span>
                                                </div>
                                                <div class="w-full bg-gray-100 rounded-full h-2"
                                                    title="120d (Inactive)">
                                                    <div class="bg-gray-400 h-2 rounded-full" style="width: 100%"></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div class="flex justify-between text-xs mb-1">
                                                    <span class="font-bold text-gray-700">C2409-015 (Muscle)</span>
                                                    <span class="text-red-500 font-bold">95d</span>
                                                </div>
                                                <div class="w-full bg-gray-100 rounded-full h-2" title="95d (Inactive)">
                                                    <div class="bg-gray-400 h-2 rounded-full" style="width: 80%"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- View: Inventory -->
                                    <div id="view-zombie-inventory" class="hidden space-y-3">
                                        <div class="text-xs text-gray-400 mb-2">ÂèëË¥ßÈÄæÊúüË∂ÖËøá 7 Â§© (Overdue > 7d)</div>
                                        <ul class="space-y-2">
                                            <li class="flex justify-between items-center p-2 bg-red-50 rounded border border-red-100"
                                                title="Produced: 5000, Shipped: 0, Stuck: 5000">
                                                <div>
                                                    <div class="text-xs font-bold text-gray-800">C2410-001 (Gummies)
                                                    </div>
                                                    <div class="text-[10px] text-red-500">Produced but not shipped (15d)
                                                    </div>
                                                </div>
                                                <div class="text-xs font-bold text-gray-800">5k Units</div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="card-footer">Showing Top 5 by Inactive/Overdue Days</div>
                            </div>

                            <!-- Widget P1-D: Data Quality (Renamed from 1E) -->
                            <!-- Widget P1-D: Data Quality Monitor (Left-Right Layout) -->
                            <div id="widget-p1d"
                                class="card bg-white border border-gray-200 shadow-sm rounded-lg lg:col-span-3 flex flex-col h-96">
                                <div
                                    class="card-header flex justify-between items-center mb-2 px-4 py-3 border-b border-gray-100">
                                    <h3 class="font-bold text-gray-800 text-lg flex items-center gap-2">
                                        <i class="fas fa-database text-purple-600"></i> <span
                                            data-i18n="p1d_title">Êï∞ÊçÆËÆ∞ÂΩïÂÆåÊï¥Â∫¶ (Data Quality)</span>
                                    </h3>
                                    <span class="text-xs text-gray-500">Last Update: 10 mins ago</span>
                                </div>

                                <div class="flex flex-1 overflow-hidden p-4 gap-4">
                                    <!-- Left: Charts (50%) -->
                                    <div class="w-1/2 flex flex-col justify-center">
                                        <div class="flex flex-1 gap-2 items-center justify-center">
                                            <!-- Chart 1: Good vs Bad -->
                                            <div class="w-1/2 relative h-40">
                                                <canvas id="dataQualityGoodBad"></canvas>
                                                <div
                                                    class="absolute inset-0 flex items-center justify-center pointer-events-none">
                                                    <div class="text-center">
                                                        <span class="text-2xl font-bold text-gray-800">92%</span><br>
                                                        <span class="text-xs text-gray-500">ÂÆåÊï¥Â∫¶</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Chart 2: Issue Types -->
                                            <div class="w-1/2 relative h-40">
                                                <canvas id="dataQualityChart"></canvas>
                                            </div>
                                        </div>
                                        <div class="mt-2 text-xs text-gray-500 text-center bg-gray-50 p-2 rounded">
                                            <i
                                                class="fas fa-info-circle mr-1"></i>Â∑¶‰æßÂ±ïÁ§∫Êï¥‰ΩìËÆ∞ÂΩïÂÆåÊï¥Â∫¶ÔºåÂè≥‰æßÂ±ïÁ§∫ÈóÆÈ¢òÁ±ªÂûãÂàÜÂ∏É„ÄÇ‰∏ÄÊù°ËÆ∞ÂΩïÂèØËÉΩÂêåÊó∂ÂåÖÂê´Â§öÁßçÈóÆÈ¢ò„ÄÇ
                                        </div>
                                    </div>

                                    <!-- Right: Detail List (50%) -->
                                    <div
                                        class="w-1/2 flex flex-col bg-white border border-gray-100 rounded-lg shadow-sm h-full">
                                        <div
                                            class="px-3 py-2 border-b border-gray-100 flex justify-between items-center bg-gray-50 rounded-t-lg">
                                            <span class="font-bold text-xs text-gray-700">ÈóÆÈ¢òÂêàÂêåÂàóË°® (Issue List)</span>
                                            <span id="p1d-current-filter"
                                                class="text-xs px-2 py-0.5 bg-purple-100 text-purple-700 rounded-full font-medium">ÂΩìÂâçÁ≠õÈÄâ:
                                                ÂÖ®ÈÉ®ÈóÆÈ¢ò</span>
                                        </div>
                                        <div class="flex-1 overflow-y-auto p-0">
                                            <table class="w-full text-left border-collapse">
                                                <thead
                                                    class="sticky top-0 bg-gray-50 text-xs font-semibold text-gray-500 z-10">
                                                    <tr>
                                                        <th class="p-2 border-b">ÂêàÂêå/‰∫ßÂìÅ (Contract)</th>
                                                        <th class="p-2 border-b">ÈóÆÈ¢ò (Issue)</th>
                                                        <th class="p-2 border-b">Êõ¥Êñ∞ (Update)</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="p1d-tbody" class="text-xs divide-y divide-gray-100">
                                                    <!-- Mock Data Rows -->
                                                    <tr class="hover:bg-gray-50 transition-colors row-issue-date">
                                                        <td class="p-2">
                                                            <div class="font-medium text-gray-800">C-2024-001</div>
                                                            <div class="text-gray-500 scale-90 origin-left">Gummies
                                                            </div>
                                                        </td>
                                                        <td class="p-2 text-red-600"><i
                                                                class="fas fa-calendar-times mr-1"></i>Áº∫Â∞ëÂèëË¥ßÊó•Êúü</td>
                                                        <td class="p-2 text-gray-500">10m ago<br>by System</td>
                                                    </tr>
                                                    <tr class="hover:bg-gray-50 transition-colors row-issue-qty">
                                                        <td class="p-2">
                                                            <div class="font-medium text-gray-800">C-2024-005</div>
                                                            <div class="text-gray-500 scale-90 origin-left">Powder</div>
                                                        </td>
                                                        <td class="p-2 text-orange-600"><i
                                                                class="fas fa-balance-scale-right mr-1"></i>Êï∞Èáè‰∏ç‰∏ÄËá¥</td>
                                                        <td class="p-2 text-gray-500">2h ago<br>by John</td>
                                                    </tr>
                                                    <tr class="hover:bg-gray-50 transition-colors row-issue-date">
                                                        <td class="p-2">
                                                            <div class="font-medium text-gray-800">C-2024-008</div>
                                                            <div class="text-gray-500 scale-90 origin-left">Liquids
                                                            </div>
                                                        </td>
                                                        <td class="p-2 text-red-600"><i
                                                                class="fas fa-calendar-times mr-1"></i>Áº∫Â∞ëÂèëË¥ßÊó•Êúü</td>
                                                        <td class="p-2 text-gray-500">1d ago<br>by System</td>
                                                    </tr>
                                                    <tr class="hover:bg-gray-50 transition-colors row-issue-other">
                                                        <td class="p-2">
                                                            <div class="font-medium text-gray-800">C-2024-012</div>
                                                            <div class="text-gray-500 scale-90 origin-left">Capsules
                                                            </div>
                                                        </td>
                                                        <td class="p-2 text-gray-600"><i
                                                                class="fas fa-exclamation-circle mr-1"></i>‰ªòÊ¨æÊó•ÊúüÁº∫Â§±</td>
                                                        <td class="p-2 text-gray-500">3d ago<br>by Finance</td>
                                                    </tr>
                                                    <tr class="hover:bg-gray-50 transition-colors row-issue-logic">
                                                        <td class="p-2">
                                                            <div class="font-medium text-gray-800">C-2024-015</div>
                                                            <div class="text-gray-500 scale-90 origin-left">Gummies
                                                            </div>
                                                        </td>
                                                        <td class="p-2 text-red-600"><i
                                                                class="fas fa-clock mr-1"></i>Êó∂Èó¥È°∫Â∫èÂºÇÂ∏∏
                                                        </td>
                                                        <td class="p-2 text-gray-500">5m ago<br>by System</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!-- Empty State (Hidden by default) -->
                                            <div id="p1d-empty-state"
                                                class="hidden flex flex-col items-center justify-center h-full text-gray-400">
                                                <i class="fas fa-check-circle text-4xl text-green-500 mb-2"></i>
                                                <p class="text-sm">ËÆ∞ÂΩïÂÆåÊï¥ ¬∑ Êó†ÈúÄË°•ÂÖÖ</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div
                                    class="px-4 py-2 border-t border-gray-100 text-xs text-gray-400 flex justify-between items-center bg-gray-50 rounded-b-lg">
                                    <span><i
                                            class="fas fa-info-circle mr-1"></i>Â∑¶‰æßÂ±ïÁ§∫Êï¥‰ΩìÊï∞ÊçÆËÆ∞ÂΩïÁöÑÂÆåÊï¥Â∫¶ÔºåÂè≥‰æßÂàóÂá∫ÂÖ∑‰ΩìÊúâÈóÆÈ¢òÁöÑÂêàÂêå‰∏é‰∫ßÂìÅÔºå‰æø‰∫éÂø´ÈÄüÂõûÊ∫ØÂπ∂Ë°•ÂÖ®‰ø°ÊÅØ„ÄÇÂΩìÂâç
                                        Demo ÁéØÂ¢É‰ΩøÁî®ÁöÑÊòØÁ§∫‰æãÊï∞ÊçÆ„ÄÇ</span>
                                </div>
                            </div>

                        </div>
                    </section>

                    <!-- ========================================== -->
                    <!-- PART 2: PROCESS LEAD TIME (Collapsed)  -->
                    <!-- ========================================== -->
                    <!-- ========================================== -->
                    <!-- PART 2: PROCESS LEAD TIME (PRD 3)      -->
                    <!-- ========================================== -->
                    <section class="mt-8">
                        <div class="flex items-center gap-2 mb-4">
                            <h2 class="text-base font-bold text-gray-800 uppercase tracking-wide border-l-4 border-secondary pl-3"
                                data-i18n="p2_title">
                                Part 2. ‰∫§‰ªòÂë®ÊúüÊ∑±Â∫¶ÈÄèËßÜ (Lead Time Deep Dive)</h2>
                            <span class="text-xs text-gray-400 italic ml-2"><i
                                    class="fa-solid fa-circle-info mr-1"></i><span data-i18n="p2_subtitle">Process
                                    Cycle vs Target</span></span>
                        </div>

                        <!-- P0: Contract Entry Latency (Banner) -->
                        <div
                            class="bg-orange-50 border border-orange-200 rounded-lg p-3 mb-6 flex items-center justify-between shadow-sm">
                            <div class="flex items-center gap-3">
                                <div
                                    class="w-8 h-8 rounded-full bg-orange-100 flex items-center justify-center text-orange-600">
                                    <i class="fa-solid fa-stopwatch-20"></i>
                                </div>
                                <div>
                                    <div class="text-sm font-bold text-gray-800">ÂêàÂêåÂΩïÂÖ•ÊèêÈÜí</div>
                                    <div class="text-xs text-gray-600">Á∫¶ 15% ÁöÑÂêàÂêåÂú®Á≠æÁ∫¶Âêé 3 Â§©ÊâçÂΩïÂÖ•Á≥ªÁªü„ÄÇ</div>
                                </div>
                            </div>
                            <button
                                class="text-xs bg-white border border-gray-300 px-3 py-1 rounded font-bold text-gray-600 hover:bg-gray-50">Êü•ÁúãÊòéÁªÜ</button>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">

                            <!-- P1: Lead Time Waterfall -->
                            <div class="card lg:col-span-2">
                                <div class="card-header">
                                    <h3 class="card-title"><i class="fa-solid fa-industry text-secondary"></i> <span
                                            data-i18n="p3b_title">3B.
                                            ‰∫ßËÉΩÂà©Áî®Áéá</span></h3>
                                    <span class="text-xs text-gray-400">Âπ≥ÂùáÂ§©Êï∞ (Avg Days)</span>
                                </div>
                                <div class="p-4 h-64">
                                    <canvas id="p1WaterfallChart"></canvas>
                                </div>
                                <div class="card-footer flex justify-between">
                                    <span>Êï¥‰Ωì‰∏≠‰ΩçÂë®ÊúüÔºö42 Â§©</span>
                                    <span>Âü∫‰∫éÂ∑≤ÂÆåÊàêÁöÑÂêàÂêå</span>
                                </div>
                                <div class="px-4 pb-2 text-xs text-gray-500">ÁõÆÂâç‰ªéÊî∂ÈΩêË¥ßÊ¨æÂà∞ÂèëË¥ßÂπ≥ÂùáÁ∫¶ 42 Â§©ÔºåÂÖ∂‰∏≠Áîü‰∫ßÂíåÂèëË¥ß‰∏§‰∏™Èò∂ÊÆµËÄóÊó∂ÊúÄÈïø„ÄÇ</div>
                            </div>

                            <!-- P2: Stage SLA Breach Rate -->
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title"><i class="fa-solid fa-chart-column text-red-500"></i> P2.
                                        ÂêÑÈò∂ÊÆµË∂ÖÂá∫ÂÜÖÈÉ®ÁõÆÊ†áÁöÑÊØî‰æã</h3>
                                </div>
                                <div class="p-4 h-64 flex flex-col">
                                    <div class="flex-1 relative">
                                        <canvas id="p2BreachChart"></canvas>
                                    </div>
                                    <div class="mt-2 text-xs text-gray-600 border-t pt-2">
                                        <div class="font-bold mb-1">‰∏ªË¶ÅÁì∂È¢à (Top Bottlenecks):</div>
                                        <div class="flex justify-between"><span>1. Áâ©ÊñôÂáÜÂ§áÈò∂ÊÆµ</span> <span
                                                class="text-red-600 font-bold">68% Ë∂ÖÂá∫ÁõÆÊ†á</span></div>
                                        <div class="flex justify-between"><span>2. Áîü‰∫ßÈò∂ÊÆµ</span> <span
                                                class="text-orange-500 font-bold">45% Ë∂ÖÂá∫ÁõÆÊ†á</span></div>
                                    </div>
                                </div>
                            </div>

                            <!-- P3: Plan Adherence -->
                            <div class="card lg:col-span-2">
                                <div class="card-header">
                                    <h3 class="card-title"><i class="fa-solid fa-calendar-check text-green-600"></i> P3.
                                        ÂêÑ‰∫ßÁ∫øÊåâÊó∂‰∫§‰ªòÊÉÖÂÜµ</h3>
                                </div>
                                <div class="p-4 h-64">
                                    <canvas id="p3AdherenceChart"></canvas>
                                </div>
                                <div class="card-footer">ËΩØÁ≥ñÂíåËÉ∂ÂõäÁöÑ‰∫§‰ªòÊúÄÁ®≥ÂÆöÔºåÁ≤âÂâÇÂª∂ËøüËæÉÂ§ö„ÄÇ</div>
                            </div>

                            <!-- P4: Materials vs Production -->
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title"><i class="fa-solid fa-boxes-stacked text-ora-warning"></i>
                                        P4.
                                        ÂºÄÂ∑•ÂâçÁâ©ÊñôÂáÜÂ§áÊÉÖÂÜµ</h3>
                                </div>
                                <div class="p-4 flex flex-col h-full">
                                    <div class="h-40 relative">
                                        <canvas id="p4MaterialChart"></canvas>
                                        <div
                                            class="absolute inset-0 flex items-center justify-center flex-col pointer-events-none">
                                            <span class="text-2xl font-bold text-gray-700">85%</span>
                                            <span class="text-[10px] text-gray-400">ÂáÜÂ§áÂ∞±Áª™</span>
                                        </div>
                                    </div>
                                    <div class="text-center text-xs text-gray-500 mt-1 mb-2">ÂΩìÂâçÁ∫¶ 85% ÁöÑÁîü‰∫ßÊâπÊ¨°Âú®ÂºÄÂ∑•ÂâçÁâ©ÊñôÂ∑≤ÂáÜÂ§áÂ∞±Áª™„ÄÇ
                                    </div>
                                    <div class="flex-1 mt-2 overflow-y-auto border-t pt-2">
                                        <div class="text-xs font-bold text-gray-700 mb-2">È£éÈô©ÊâπÊ¨°ÔºàÂºÄÂ∑•Êó∂Áâ©ÊñôÊú™ÂÆåÂÖ®Âà∞‰ΩçÔºâ</div>
                                        <ul class="space-y-1">
                                            <li class="flex justify-between text-xxs text-gray-600"><span>C2411-05
                                                    (Gummies)</span> <span class="text-red-500 font-bold">-2d</span>
                                            </li>
                                            <li class="flex justify-between text-xxs text-gray-600"><span>C2411-08
                                                    (Powder)</span> <span class="text-red-500 font-bold">-1d</span></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- G1: Factory Growth -->
                        <div class="card mb-8">
                            <div class="card-header">
                                <h3 class="card-title"><i class="fa-solid fa-arrow-trend-up text-ora-primary"></i> G1.
                                    Â∑•ÂéÇ‰∫ßÂá∫‰∏éÊïàÁéáÊèêÂçá
                                </h3>
                                <span class="text-xs text-gray-400">Â≠£Â∫¶Âá∫Ë¥ßË∂ãÂäø</span>
                            </div>
                            <div class="p-6 grid grid-cols-1 lg:grid-cols-4 gap-6">
                                <!-- Chart -->
                                <div class="lg:col-span-3 h-64">
                                    <canvas id="g1GrowthChart"></canvas>
                                    <div class="text-center text-xs text-gray-500 mt-2">Q4 È¢ÑËÆ°Âá∫Ë¥ß 120 ‰∏á‰ª∂ÔºåËæÉ‰∏äÂ≠£Â∫¶Â¢ûÈïø
                                        15%ÔºõÂπ≥Âùá‰∫§‰ªòÊó∂Èó¥ÊØîÂàùÂßãÈò∂ÊÆµÁº©Áü≠Á∫¶
                                        3 Â§©„ÄÇ</div>
                                </div>
                                <!-- KPIs -->
                                <div class="space-y-4">
                                    <div class="bg-gray-50 p-4 rounded border border-gray-100">
                                        <div class="text-xs text-gray-500 uppercase font-bold">Êú¨Â≠£Â∫¶Âá∫Ë¥ßÊÄªÈáè</div>
                                        <div class="text-2xl font-bold text-gray-800 mt-1">1.2M</div>
                                        <div class="text-xs text-green-600 mt-1"><i class="fa-solid fa-arrow-up"></i>
                                            15%
                                            QoQ
                                        </div>
                                    </div>
                                    <div class="bg-gray-50 p-4 rounded border border-gray-100">
                                        <div class="text-xs text-gray-500 uppercase font-bold">Âπ≥Âùá‰∫§‰ªòÊó∂Èó¥</div>
                                        <div class="text-2xl font-bold text-gray-800 mt-1">42d</div>
                                        <div class="text-xs text-green-600 mt-1"><i class="fa-solid fa-arrow-down"></i>
                                            3d
                                            vs
                                            Baseline</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- ========================================== -->
                    <!-- PART 3: CLIENT & OPPORTUNITY RADAR (PRD 4) -->
                    <!-- ========================================== -->
                    <section class="pb-10 mt-8">
                        <div class="flex items-center gap-2 mb-4">
                            <h2 class="text-base font-bold text-gray-800 uppercase tracking-wide border-l-4 border-secondary pl-3"
                                data-i18n="p3_title">
                                Part 3. ÂÆ¢Êà∑‰∏é‰∫ßËÉΩÈõ∑Ëææ (Client & Capacity Radar)</h2>
                            <span class="text-xs text-gray-400">Q3 2024 vs Q4 2024</span>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

                            <!-- 3A: Client Risk -->
                            <div class="card lg:col-span-2">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        <i class="fa-solid fa-user-shield text-ora-primary"></i> <span
                                            data-i18n="p3a_title">3A.
                                            ÂÆ¢Êà∑È£éÈô©È¢ÑË≠¶</span>
                                    </h3>
                                </div>
                                <div class="p-4">
                                    <!-- Visual: Bar Chart for Vol Comparison -->
                                    <div class="w-full h-40">
                                        <canvas id="clientRiskChart"></canvas>
                                        <div class="text-center text-xs text-gray-500 mt-2">Á∫¢Ëâ≤Ë°®Á§∫Êú¨Â≠£Â∫¶ÂÆåÂÖ®Ê≤°‰∏ãÂçïÔºåÊ©ôËâ≤Ë°®Á§∫ËÆ¢ÂçïÈáèÊòéÊòæ‰∏ãÈôç„ÄÇ
                                        </div>
                                    </div>
                                    <!-- List: Details -->
                                    <div class="w-full overflow-x-auto mt-4">
                                        <table class="w-full text-left text-xs">
                                            <thead class="bg-gray-50 text-gray-500 uppercase border-b border-gray-200">
                                                <tr>
                                                    <th class="px-4 py-2">ÂìÅÁâå</th>
                                                    <th class="px-4 py-2">Áä∂ÊÄÅ</th>
                                                    <th class="px-4 py-2 text-right">ÊúÄËøëÂá†Â≠£Âá∫Ë¥ßÈáè (ÂØπÊØî)</th>
                                                </tr>
                                            </thead>
                                            <tbody class="divide-y divide-gray-100">
                                                <tr>
                                                    <td class="px-4 py-2 font-bold">Vitality</td>
                                                    <td class="px-4 py-2"><span
                                                            class="bg-red-100 text-red-700 px-2 py-0.5 rounded-full text-xxs">Êú¨Â≠£Êú™‰∏ãÂçï</span>
                                                    </td>
                                                    <td class="px-4 py-2 text-right text-gray-400">60k <i
                                                            class="fa-solid fa-arrow-right text-gray-300 mx-1"></i>
                                                        <span class="text-red-600 font-bold">0</span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-4 py-2 font-bold">Muscle</td>
                                                    <td class="px-4 py-2"><span
                                                            class="bg-orange-100 text-orange-700 px-2 py-0.5 rounded-full text-xxs">‰∏ãÂçïÊòéÊòæÂèòÂ∞ë</span>
                                                    </td>
                                                    <td class="px-4 py-2 text-right text-gray-400">60k <i
                                                            class="fa-solid fa-arrow-right text-gray-300 mx-1"></i>
                                                        <span class="text-orange-500 font-bold">25k</span>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="card-footer">Based on quarterly volume comparison</div>
                            </div>

                            <!-- Widget 3C: Capacity Concentration -->
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title"><i class="fa-solid fa-chart-pie text-secondary"></i> <span
                                            data-i18n="p3c_title">3C.
                                            ÂìÅÁâå‰∫ßËÉΩÈõÜ‰∏≠Â∫¶</span>
                                    </h3>
                                </div>
                                <div class="p-4 flex flex-col justify-between h-full">
                                    <div class="h-32 relative">
                                        <canvas id="concentrationChart"></canvas>
                                    </div>
                                    <!-- Risk Warning -->
                                    <div class="mt-2 text-xs border-l-2 border-ora-danger pl-2 text-gray-600">
                                        <span class="font-bold text-ora-danger">High Risk:</span> ÂΩìÂâçÂâç‰∏âÂ§ßÂÆ¢Êà∑Âç†Áî®Êéí‰∫ß‰∫ßËÉΩÁ∫¶
                                        72%ÔºåÈõÜ‰∏≠Â∫¶ÂÅèÈ´ò„ÄÇ
                                    </div>
                                </div>
                                <div class="card-footer">Based on scheduled units</div>
                            </div>

                            <!-- Widget 3D: White Space Matrix (PRD 4.4) -->
                            <div class="card lg:col-span-3">
                                <div class="card-header">
                                    <h3 class="card-title"><i class="fa-solid fa-border-all text-teal-600"></i> P3-D.
                                        ÂâÇÂûãÁôΩÂú∞
                                        (White Space)</h3>
                                    <div class="flex items-center gap-2 text-xxs">
                                        <span class="w-3 h-3 bg-teal-600 rounded-sm"></span> Ê†∏ÂøÉ‰∏öÂä°
                                        <span class="w-3 h-3 bg-teal-100 rounded-sm"></span> ÂÅ∂Â∞îÁîü‰∫ß
                                        <span class="w-3 h-3 border border-gray-300 border-dashed rounded-sm"></span>
                                        ‰ªéÊú™Âêà‰Ωú
                                    </div>
                                </div>
                                <div class="p-4 overflow-x-auto">
                                    <table class="w-full text-xs text-center border-collapse">
                                        <thead>
                                            <tr>
                                                <th class="px-3 py-2 text-left font-bold text-gray-600 bg-gray-50 w-40">
                                                    ÂìÅÁâå /
                                                    ÂâÇÂûã
                                                </th>
                                                <th class="px-1 py-2 font-medium text-gray-500 bg-gray-50">Gummies</th>
                                                <th class="px-1 py-2 font-medium text-gray-500 bg-gray-50">Powder</th>
                                                <th class="px-1 py-2 font-medium text-gray-500 bg-gray-50">Liquids</th>
                                                <th class="px-1 py-2 font-medium text-gray-500 bg-gray-50">Capsules</th>
                                            </tr>
                                        </thead>
                                        <tbody class="text-gray-600">
                                            <tr class="border-b border-gray-50">
                                                <td class="p-3 text-left font-bold">Little Umbrella</td>
                                                <td class="p-1">
                                                    <div class="bg-teal-600 text-white py-2 rounded shadow-sm"
                                                        title="Volume > strong_threshold in last 2y">Ê†∏ÂøÉ‰∏öÂä°</div>
                                                </td>
                                                <td class="p-1">
                                                    <div class="bg-teal-100 text-teal-800 py-2 rounded"
                                                        title="Volume between 0 and threshold">ÂÅ∂Â∞îÁîü‰∫ß</div>
                                                </td>
                                                <td class="p-1">
                                                    <div class="border border-dashed border-gray-300 text-gray-300 py-2 rounded hover:bg-gray-50 cursor-pointer"
                                                        title="No production in last 2y">
                                                        ‰ªéÊú™Âêà‰Ωú</div>
                                                </td>
                                                <td class="p-1">
                                                    <div class="border border-dashed border-gray-300 text-gray-300 py-2 rounded hover:bg-gray-50 cursor-pointer"
                                                        title="No production in last 2y">
                                                        ‰ªéÊú™Âêà‰Ωú</div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="p-3 text-left font-bold">PowerGums</td>
                                                <td class="p-1">
                                                    <div class="bg-teal-600 text-white py-2 rounded shadow-sm"
                                                        title="Volume > strong_threshold in last 2y">Strong</div>
                                                </td>
                                                <td class="p-1">
                                                    <div class="border border-dashed border-gray-300 text-gray-300 py-2 rounded hover:bg-gray-50 cursor-pointer"
                                                        title="No production in last 2y">Gap</div>
                                                </td>
                                                <td class="p-1">
                                                    <div class="border border-dashed border-gray-300 text-gray-300 py-2 rounded hover:bg-gray-50 cursor-pointer"
                                                        title="No production in last 2y">Gap</div>
                                                </td>
                                                <td class="p-1">
                                                    <div class="border border-dashed border-gray-300 text-gray-300 py-2 rounded hover:bg-gray-50 cursor-pointer"
                                                        title="No production in last 2y">Gap</div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                        </div>
                    </section>
                </div>
            </div>

            <!-- PAGE: CONTRACT TABLE -->
            <div id="page-contracts" class="hidden flex-1 flex flex-col overflow-hidden relative h-full bg-white">
                <!-- Contract Content (Scrollable) -->
                <div class="flex-1 overflow-auto bg-white relative p-4">
                    <!-- Header Controls -->
                    <div class="mb-4">
                        <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4">
                            <div>
                                <h1 class="text-xl font-bold text-gray-900" data-i18n="ct_title">Contract Table</h1>
                                <p class="text-xs text-gray-500" data-i18n="ct_date_range">2024-06-01 ~ 2024-08-31</p>
                            </div>

                            <div class="flex flex-wrap gap-2 items-center">
                                <div class="relative">
                                    <input type="text" placeholder="Search contracts..."
                                        class="text-sm border-gray-300 rounded-md shadow-sm pl-8 pr-3 py-1.5 focus:border-[#297A88] focus:ring focus:ring-[#297A88] focus:ring-opacity-20"
                                        data-i18n="ct_search">
                                    <i
                                        class="fa-solid fa-magnifying-glass absolute left-2.5 top-2 text-gray-400 text-xs"></i>
                                </div>

                                <button
                                    class="bg-[#297A88] text-white px-4 py-1.5 rounded text-sm hover:bg-[#066070] transition shadow-sm font-bold flex items-center gap-2">
                                    <i class="fa-solid fa-plus"></i> <span data-i18n="ct_import">Import New</span>
                                </button>
                            </div>
                        </div>

                        <!-- Toolbar -->
                        <div class="flex flex-col sm:flex-row justify-between items-center gap-4">
                            <!-- Left Filters -->
                            <div class="flex gap-2 w-full sm:w-auto">
                                <button
                                    class="bg-[#066070] text-white px-3 py-1 rounded text-xs font-bold shadow-sm">All ¬∑
                                    4</button>
                                <button
                                    class="bg-white border border-gray-300 text-gray-600 px-3 py-1 rounded text-xs hover:bg-gray-50 font-bold">Pending
                                    Scheduling ¬∑ 4</button>
                                <button
                                    class="bg-white border border-gray-300 text-gray-600 px-3 py-1 rounded text-xs hover:bg-gray-50 flex items-center gap-1 font-bold">
                                    More <i class="fa-solid fa-chevron-down text-[10px]"></i>
                                </button>
                            </div>

                            <!-- Right Role Tabs (Now Functional) -->
                            <div
                                class="flex items-center gap-1 text-xs font-bold text-gray-600 bg-gray-100 p-1 rounded-lg">
                                <button onclick="switchContractTab('reqs')" id="tab-ct-reqs"
                                    class="px-3 py-1 rounded-md bg-white text-[#006064] shadow-sm transition-all"
                                    data-i18n="ct_role_reqs">Reqs</button>
                                <button onclick="switchContractTab('fin')" id="tab-ct-fin"
                                    class="px-3 py-1 rounded-md hover:bg-white/50 text-gray-500 transition-all font-normal"
                                    data-i18n="ct_role_fin">Finance</button>
                                <button onclick="switchContractTab('pkg')" id="tab-ct-pkg"
                                    class="px-3 py-1 rounded-md hover:bg-white/50 text-gray-500 transition-all font-normal"
                                    data-i18n="ct_role_pkg">Pkg</button>
                                <button onclick="switchContractTab('plan')" id="tab-ct-plan"
                                    class="px-3 py-1 rounded-md hover:bg-white/50 text-gray-500 transition-all font-normal"
                                    data-i18n="ct_role_plan">Plan</button>
                            </div>
                        </div>
                    </div>

                    <!-- Table Container -->
                    <div class="relative overflow-x-auto border rounded-lg border-gray-200">
                        <table class="w-full text-left border-collapse whitespace-nowrap">
                            <thead class="bg-gray-50 text-gray-500 text-xs uppercase border-b border-gray-200">
                                <tr>
                                    <!-- Fixed Columns -->
                                    <th class="px-3 py-3 font-semibold w-24" data-i18n="ct_th_date">Date</th>
                                    <th class="px-3 py-3 font-semibold w-32" data-i18n="ct_th_no">Contract No</th>
                                    <th class="px-3 py-3 font-semibold w-20" data-i18n="ct_th_brand">Brand</th>
                                    <th class="px-3 py-3 font-semibold w-40" data-i18n="ct_th_prod">Product</th>
                                    <th class="px-3 py-3 font-semibold w-24" data-i18n="ct_th_spec">Spec</th>
                                    <th class="px-3 py-3 font-semibold w-24" data-i18n="ct_th_qty">Qty</th>
                                    <th class="px-3 py-3 font-semibold w-32" data-i18n="ct_th_status">Status</th>

                                    <!-- Dynamic Columns: Reqs -->
                                    <th class="col-reqs px-3 py-3 font-semibold bg-blue-50/50 text-blue-800 border-l border-gray-200"
                                        data-i18n="ct_th_reqs_gacc">GACC</th>
                                    <th class="col-reqs px-3 py-3 font-semibold bg-blue-50/50 text-blue-800"
                                        data-i18n="ct_th_reqs_code">Coding</th>
                                    <th class="col-reqs px-3 py-3 font-semibold bg-blue-50/50 text-blue-800"
                                        data-i18n="ct_th_reqs_ship">Ship Mode</th>
                                    <th class="col-reqs px-3 py-3 font-semibold bg-blue-50/50 text-blue-800"
                                        data-i18n="ct_th_reqs_label">Label</th>
                                    <th class="col-reqs px-3 py-3 font-semibold bg-blue-50/50 text-blue-800"
                                        data-i18n="ct_th_reqs_other">Other</th>

                                    <!-- Dynamic Columns: Finance (Hidden by default) -->
                                    <th class="col-fin hidden px-3 py-3 font-semibold bg-green-50/50 text-green-800 border-l border-gray-200"
                                        data-i18n="ct_th_fin_inv">Invoice #</th>
                                    <th class="col-fin hidden px-3 py-3 font-semibold bg-green-50/50 text-green-800"
                                        data-i18n="ct_th_fin_dep">Deposit</th>
                                    <th class="col-fin hidden px-3 py-3 font-semibold bg-green-50/50 text-green-800"
                                        data-i18n="ct_th_fin_pre">Pre-Prod</th>
                                    <th class="col-fin hidden px-3 py-3 font-semibold bg-green-50/50 text-green-800"
                                        data-i18n="ct_th_fin_bal">Balance</th>

                                    <!-- Dynamic Columns: Pkg (Hidden by default) -->
                                    <th class="col-pkg hidden px-3 py-3 font-semibold bg-purple-50/50 text-purple-800 border-l border-gray-200"
                                        data-i18n="ct_th_pkg_inv">Invoice #</th>
                                    <th class="col-pkg hidden px-3 py-3 font-semibold bg-purple-50/50 text-purple-800"
                                        data-i18n="ct_th_pkg_dep">Deposit</th>
                                    <th class="col-pkg hidden px-3 py-3 font-semibold bg-purple-50/50 text-purple-800"
                                        data-i18n="ct_th_pkg_pre">Pre-Prod</th>
                                    <th class="col-pkg hidden px-3 py-3 font-semibold bg-purple-50/50 text-purple-800"
                                        data-i18n="ct_th_pkg_bal">Balance</th>

                                    <!-- Dynamic Columns: Plan (Hidden by default) -->
                                    <th class="col-plan hidden px-3 py-3 font-semibold bg-orange-50/50 text-orange-800 border-l border-gray-200"
                                        data-i18n="ct_th_plan_mat">Material Stock</th>
                                    <th class="col-plan hidden px-3 py-3 font-semibold bg-orange-50/50 text-orange-800"
                                        data-i18n="ct_th_plan_sch">Schedule Log</th>

                                    <th
                                        class="px-3 py-3 font-semibold text-center w-10 sticky right-0 bg-gray-50 shadow-[-5px_0_5px_-5px_0_rgba(0,0,0,0.1)]">
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="text-xs text-gray-700 divide-y divide-gray-100 bg-white">
                                <!-- Row 1: New Contract (Red) -->
                                <tr class="hover:bg-gray-50 transition-colors border-b border-gray-100 group">
                                    <td class="px-3 py-2 text-gray-500 whitespace-nowrap">07/01/2025</td>
                                    <td class="px-3 py-2 font-medium whitespace-gray-800">LTUM-202502001</td>
                                    <td class="px-3 py-2 whitespace-nowrap">Little</td>
                                    <td class="px-3 py-2 max-w-[160px] truncate"
                                        title="Liquid Calcium (Xylitol verison 2)">Liquid Calcium (Xylitol...</td>
                                    <td class="px-3 py-2 text-gray-500">10ml/sachet</td>
                                    <td class="px-3 py-2">900,000</td>
                                    <td class="px-3 py-2">
                                        <div class="flex flex-row items-center gap-2">
                                            <div class="w-2 h-2 rounded-full bg-[#EF4444] flex-shrink-0"></div>
                                            <div class="flex flex-col leading-tight">
                                                <span class="font-bold text-gray-800"
                                                    data-i18n="ct_status_new_1">New</span>
                                                <span class="text-[10px] text-gray-500"
                                                    data-i18n="ct_status_new_2">Contract</span>
                                            </div>
                                        </div>
                                    </td>

                                    <!-- Reqs Cells -->
                                    <td class="col-reqs px-3 py-2 border-l border-gray-100 text-gray-400">‚Äî</td>
                                    <td class="col-reqs px-3 py-2 text-gray-400">‚Äî</td>
                                    <td class="col-reqs px-3 py-2 font-medium">FOB Shanghai</td>
                                    <td class="col-reqs px-3 py-2 text-gray-400">‚Äî</td>
                                    <td class="col-reqs px-3 py-2 text-gray-400">‚Äî</td>

                                    <!-- Fin Cells -->
                                    <td class="col-fin hidden px-3 py-2 border-l border-gray-100 font-mono">INV-2024001
                                    </td>
                                    <td class="col-fin hidden px-3 py-2 text-green-600"><i
                                            class="fa-solid fa-check"></i> Paid</td>
                                    <td class="col-fin hidden px-3 py-2 text-gray-400">Pending</td>
                                    <td class="col-fin hidden px-3 py-2 text-gray-400">Pending</td>

                                    <!-- Pkg Cells -->
                                    <td class="col-pkg hidden px-3 py-2 border-l border-gray-100 text-gray-400">‚Äî</td>
                                    <td class="col-pkg hidden px-3 py-2 text-gray-400">‚Äî</td>
                                    <td class="col-pkg hidden px-3 py-2 text-gray-400">‚Äî</td>
                                    <td class="col-pkg hidden px-3 py-2 text-gray-400">‚Äî</td>

                                    <!-- Plan Cells -->
                                    <td class="col-plan hidden px-3 py-2 border-l border-gray-100"><span
                                            class="px-2 py-0.5 bg-yellow-100 text-yellow-700 rounded-full text-[10px]">Partial</span>
                                    </td>
                                    <td class="col-plan hidden px-3 py-2 text-gray-500">Scheduled: 2025-02-10</td>

                                    <td
                                        class="px-3 py-2 text-center sticky right-0 bg-white group-hover:bg-gray-50 shadow-[-5px_0_5px_-5px_0_rgba(0,0,0,0.1)]">
                                        <i class="fa-solid fa-ellipsis hover:text-[#297A88] cursor-pointer p-1"></i>
                                    </td>
                                </tr>

                                <!-- Row 2: Pending -->
                                <tr class="hover:bg-gray-50 transition-colors border-b border-gray-100 group">
                                    <td class="px-3 py-2 text-gray-500 whitespace-nowrap">07/01/2025</td>
                                    <td class="px-3 py-2 font-medium whitespace-gray-800">LTUM-202502002</td>
                                    <td class="px-3 py-2 whitespace-nowrap">Little</td>
                                    <td class="px-3 py-2 max-w-[160px] truncate"
                                        title="Liquid Calcium (Xylitol verison 2)">Liquid Calcium (Xylitol...</td>
                                    <td class="px-3 py-2 text-gray-500">10ml/sachet</td>
                                    <td class="px-3 py-2">900,000</td>
                                    <td class="px-3 py-2">
                                        <div class="flex flex-row items-center gap-2">
                                            <div class="w-2 h-2 rounded-full bg-[#EF4444] flex-shrink-0"></div>
                                            <div class="flex flex-col leading-tight">
                                                <span class="font-bold text-gray-800"
                                                    data-i18n="ct_status_pending_1">Pending</span>
                                                <span class="text-[10px] text-gray-500"
                                                    data-i18n="ct_status_pending_2">Preparation</span>
                                            </div>
                                        </div>
                                    </td>

                                    <!-- Reqs Cells -->
                                    <td class="col-reqs px-3 py-2 border-l border-gray-100 text-green-600"><i
                                            class="fa-solid fa-check"></i> Done</td>
                                    <td class="col-reqs px-3 py-2">Inkjet</td>
                                    <td class="col-reqs px-3 py-2 font-medium">CIF Melbourne</td>
                                    <td class="col-reqs px-3 py-2 text-green-600"><i class="fa-solid fa-check"></i>
                                        Confirmed</td>
                                    <td class="col-reqs px-3 py-2 text-gray-400">‚Äî</td>

                                    <!-- Fin Cells -->
                                    <td class="col-fin hidden px-3 py-2 border-l border-gray-100 font-mono">INV-2024002
                                    </td>
                                    <td class="col-fin hidden px-3 py-2 text-green-600"><i
                                            class="fa-solid fa-check"></i> Paid</td>
                                    <td class="col-fin hidden px-3 py-2 text-green-600"><i
                                            class="fa-solid fa-check"></i> Paid</td>
                                    <td class="col-fin hidden px-3 py-2 text-gray-400">Pending</td>

                                    <!-- Pkg Cells -->
                                    <td class="col-pkg hidden px-3 py-2 border-l border-gray-100 text-gray-400">‚Äî</td>
                                    <td class="col-pkg hidden px-3 py-2 text-gray-400">‚Äî</td>
                                    <td class="col-pkg hidden px-3 py-2 text-gray-400">‚Äî</td>
                                    <td class="col-pkg hidden px-3 py-2 text-gray-400">‚Äî</td>

                                    <!-- Plan Cells -->
                                    <td class="col-plan hidden px-3 py-2 border-l border-gray-100"><span
                                            class="px-2 py-0.5 bg-green-100 text-green-700 rounded-full text-[10px]">Ready</span>
                                    </td>
                                    <td class="col-plan hidden px-3 py-2 text-gray-500">Batch-A start 2025/02/15</td>

                                    <td
                                        class="px-3 py-2 text-center sticky right-0 bg-white group-hover:bg-gray-50 shadow-[-5px_0_5px_-5px_0_rgba(0,0,0,0.1)]">
                                        <i class="fa-solid fa-ellipsis hover:text-[#297A88] cursor-pointer p-1"></i>
                                    </td>
                                </tr>

                                <!-- Row 3: Ongoing -->
                                <tr class="hover:bg-gray-50 transition-colors border-b border-gray-100 group">
                                    <td class="px-3 py-2 text-gray-500 whitespace-nowrap">07/01/2025</td>
                                    <td class="px-3 py-2 font-medium whitespace-gray-800">LTUM-202502003</td>
                                    <td class="px-3 py-2 whitespace-nowrap">Little</td>
                                    <td class="px-3 py-2 max-w-[160px] truncate"
                                        title="Liquid Calcium (Xylitol verison 2)">Liquid Calcium (Xylitol...</td>
                                    <td class="px-3 py-2 text-gray-500">10ml/sachet</td>
                                    <td class="px-3 py-2">900,000</td>
                                    <td class="px-3 py-2">
                                        <div class="flex flex-row items-center gap-2">
                                            <div class="w-2 h-2 rounded-full bg-[#F59E0B] flex-shrink-0"></div>
                                            <div class="flex flex-col leading-tight">
                                                <span class="font-bold text-gray-800"
                                                    data-i18n="ct_status_ongoing_1">Production</span>
                                                <span class="text-[10px] text-gray-500"
                                                    data-i18n="ct_status_ongoing_2">On-Going</span>
                                            </div>
                                        </div>
                                    </td>

                                    <!-- Reqs Cells -->
                                    <td class="col-reqs px-3 py-2 border-l border-gray-100 text-green-600"><i
                                            class="fa-solid fa-check"></i> Done</td>
                                    <td class="col-reqs px-3 py-2">Inkjet</td>
                                    <td class="col-reqs px-3 py-2 font-medium">CIF Melbourne</td>
                                    <td class="col-reqs px-3 py-2 text-green-600"><i class="fa-solid fa-check"></i>
                                        Confirmed</td>
                                    <td class="col-reqs px-3 py-2 text-gray-400">Palletized</td>

                                    <!-- Fin Cells -->
                                    <td class="col-fin hidden px-3 py-2 border-l border-gray-100 font-mono">INV-2024003
                                    </td>
                                    <td class="col-fin hidden px-3 py-2 text-green-600"><i
                                            class="fa-solid fa-check"></i> Paid</td>
                                    <td class="col-fin hidden px-3 py-2 text-green-600"><i
                                            class="fa-solid fa-check"></i> Paid</td>
                                    <td class="col-fin hidden px-3 py-2 text-gray-400">Pending</td>

                                    <!-- Pkg Cells -->
                                    <td class="col-pkg hidden px-3 py-2 border-l border-gray-100 text-gray-400">‚Äî</td>
                                    <td class="col-pkg hidden px-3 py-2 text-gray-400">‚Äî</td>
                                    <td class="col-pkg hidden px-3 py-2 text-gray-400">‚Äî</td>
                                    <td class="col-pkg hidden px-3 py-2 text-gray-400">‚Äî</td>

                                    <!-- Plan Cells -->
                                    <td class="col-plan hidden px-3 py-2 border-l border-gray-100"><span
                                            class="px-2 py-0.5 bg-green-100 text-green-700 rounded-full text-[10px]">Ready</span>
                                    </td>
                                    <td class="col-plan hidden px-3 py-2 text-gray-500">In Production (Stage 3)</td>

                                    <td
                                        class="px-3 py-2 text-center sticky right-0 bg-white group-hover:bg-gray-50 shadow-[-5px_0_5px_-5px_0_rgba(0,0,0,0.1)]">
                                        <i class="fa-solid fa-ellipsis hover:text-[#297A88] cursor-pointer p-1"></i>
                                    </td>
                                </tr>

                                <!-- Row 4: Done -->
                                <tr class="hover:bg-gray-50 transition-colors border-b border-gray-100 group">
                                    <td class="px-3 py-2 text-gray-500 whitespace-nowrap">07/01/2025</td>
                                    <td class="px-3 py-2 font-medium whitespace-gray-800">LTUM-202502004</td>
                                    <td class="px-3 py-2 whitespace-nowrap">Little</td>
                                    <td class="px-3 py-2 max-w-[160px] truncate"
                                        title="Liquid Calcium (Xylitol verison 3)">Liquid Calcium (Xylitol...</td>
                                    <td class="px-3 py-2 text-gray-500">10ml/sachet</td>
                                    <td class="px-3 py-2">900,000</td>
                                    <td class="px-3 py-2">
                                        <div class="flex flex-row items-center gap-2">
                                            <div class="w-2 h-2 rounded-full bg-[#10B981] flex-shrink-0"></div>
                                            <div class="flex flex-col leading-tight">
                                                <span class="font-bold text-gray-800"
                                                    data-i18n="ct_status_done">Done</span>
                                            </div>
                                        </div>
                                    </td>

                                    <!-- Reqs Cells -->
                                    <td class="col-reqs px-3 py-2 border-l border-gray-100 text-green-600"><i
                                            class="fa-solid fa-check"></i> Done</td>
                                    <td class="col-reqs px-3 py-2">Inkjet</td>
                                    <td class="col-reqs px-3 py-2 font-medium">CIF Melbourne</td>
                                    <td class="col-reqs px-3 py-2 text-green-600"><i class="fa-solid fa-check"></i>
                                        Confirmed</td>
                                    <td class="col-reqs px-3 py-2 text-gray-400">‚Äî</td>

                                    <!-- Fin Cells -->
                                    <td class="col-fin hidden px-3 py-2 border-l border-gray-100 font-mono">INV-2024004
                                    </td>
                                    <td class="col-fin hidden px-3 py-2 text-green-600"><i
                                            class="fa-solid fa-check"></i> Paid</td>
                                    <td class="col-fin hidden px-3 py-2 text-green-600"><i
                                            class="fa-solid fa-check"></i> Paid</td>
                                    <td class="col-fin hidden px-3 py-2 text-green-600"><i
                                            class="fa-solid fa-check"></i> Paid</td>

                                    <!-- Pkg Cells -->
                                    <td class="col-pkg hidden px-3 py-2 border-l border-gray-100 text-gray-400">‚Äî</td>
                                    <td class="col-pkg hidden px-3 py-2 text-gray-400">‚Äî</td>
                                    <td class="col-pkg hidden px-3 py-2 text-gray-400">‚Äî</td>
                                    <td class="col-pkg hidden px-3 py-2 text-gray-400">‚Äî</td>

                                    <!-- Plan Cells -->
                                    <td class="col-plan hidden px-3 py-2 border-l border-gray-100"><span
                                            class="px-2 py-0.5 bg-green-100 text-green-700 rounded-full text-[10px]">Ready</span>
                                    </td>
                                    <td class="col-plan hidden px-3 py-2 text-gray-500">Shipped 2025-01-20</td>

                                    <td
                                        class="px-3 py-2 text-center sticky right-0 bg-white group-hover:bg-gray-50 shadow-[-5px_0_5px_-5px_0_rgba(0,0,0,0.1)]">
                                        <i class="fa-solid fa-ellipsis hover:text-[#297A88] cursor-pointer p-1"></i>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>

        <!-- LOGIC -->
        <script>
            // --- Page Switching Logic ---
            function switchPage(pageId) {
                const dashboard = document.getElementById('page-dashboard');
                const contracts = document.getElementById('page-contracts');
                const btnDash = document.getElementById('nav-btn-dashboard');
                const btnCont = document.getElementById('nav-btn-contracts');

                // Define Styles
                const btnActive = "w-full h-14 flex items-center justify-center bg-[#066070] transition-all shadow-inner";
                const btnInactive = "w-full h-14 flex items-center justify-center text-white/70 hover:bg-[#066070]/30 transition-all group";

                if (pageId === 'dashboard') {
                    dashboard.classList.remove('hidden');
                    contracts.classList.add('hidden');

                    // Update Buttons
                    btnDash.className = btnActive;
                    if (btnDash.querySelector('img')) btnDash.querySelector('img').classList.remove('opacity-70');
                    if (btnDash.querySelector('img')) btnDash.querySelector('img').classList.remove('group-hover:opacity-100');

                    btnCont.className = btnInactive;
                    if (btnCont.querySelector('img')) btnCont.querySelector('img').classList.add('opacity-70');
                    if (btnCont.querySelector('img')) btnCont.querySelector('img').classList.add('group-hover:opacity-100');

                } else if (pageId === 'contracts') {
                    dashboard.classList.add('hidden');
                    contracts.classList.remove('hidden');

                    // Update Buttons
                    btnCont.className = btnActive;
                    if (btnCont.querySelector('img')) btnCont.querySelector('img').classList.remove('opacity-70');
                    if (btnCont.querySelector('img')) btnCont.querySelector('img').classList.remove('group-hover:opacity-100');

                    btnDash.className = btnInactive;
                    if (btnDash.querySelector('img')) btnDash.querySelector('img').classList.add('opacity-70');
                    if (btnDash.querySelector('img')) btnDash.querySelector('img').classList.add('group-hover:opacity-100');
                }
            }

            // --- Global State ---
            let currentFilter = null;

            // --- Widget P1-A: KPI Filter Logic ---
            function toggleKpiFilterP1(cardId, filterType) {
                const card = document.getElementById(cardId);
                const allCards = document.querySelectorAll('.kpi-card');

                // Toggle Active State
                if (currentFilter === cardId) {
                    card.classList.remove('active-filter');
                    currentFilter = null;
                    // Reset P1-B to All
                    filterP1B('all');
                    return;
                }

                allCards.forEach(c => c.classList.remove('active-filter'));
                card.classList.add('active-filter');
                currentFilter = cardId;

                // Handle Filter Actions
                if (filterType === 'data_issue') {
                    // Scroll to P1-D
                    const p1d = document.getElementById('widget-p1d');
                    p1d.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    p1d.classList.add('target-highlight');
                    setTimeout(() => p1d.classList.remove('target-highlight'), 2000);
                    // Show all bad records
                    filterDataQuality('bad');
                } else {
                    // Scroll to P1-B
                    const p1b = document.getElementById('widget-p1b');
                    p1b.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    p1b.classList.add('target-highlight');
                    setTimeout(() => p1b.classList.remove('target-highlight'), 2000);

                    // Apply Filter to P1-B
                    if (filterType === 'leadtime') {
                        filterP1B('delay');
                    } else if (filterType === 'money') {
                        filterP1B('blocker'); // For demo, we just show blockers. In real app, filter by reason=money
                    } else if (filterType === 'materials') {
                        filterP1B('blocker');
                    }
                }
            }

            // --- Widget P1-B: Internal Filter ---
            function filterP1B(filterType) {
                // Update Buttons
                ['all', 'blocker', 'delay'].forEach(t => {
                    const btn = document.getElementById(`btn-p1b-${t}`);
                    if (t === filterType) {
                        btn.classList.remove('tab-inactive');
                        btn.classList.add('tab-active');
                    } else {
                        btn.classList.remove('tab-active');
                        btn.classList.add('tab-inactive');
                    }
                });

                // Filter Rows
                const rows = document.querySelectorAll('#p1b-tbody tr');
                rows.forEach(row => {
                    if (filterType === 'all') {
                        row.classList.remove('hidden');
                    } else if (filterType === 'blocker') {
                        if (row.classList.contains('row-blocker')) row.classList.remove('hidden');
                        else row.classList.add('hidden');
                    } else if (filterType === 'delay') {
                        if (row.classList.contains('row-delay')) row.classList.remove('hidden');
                        else row.classList.add('hidden');
                    }
                });
            }

            // --- View Switching (List vs Graph) ---
            function switchView(widgetId, viewType) {
                const btnList = document.getElementById(`btn-${widgetId}-view-list`);
                const btnGraph = document.getElementById(`btn-${widgetId}-view-graph`);
                const viewList = document.getElementById(`${widgetId}-view-list`);
                const viewGraph = document.getElementById(`${widgetId}-view-graph`);

                if (viewType === 'list') {
                    btnList.className = 'px-2 py-0.5 text-xs rounded bg-white shadow-sm font-bold text-gray-800 border border-gray-200';
                    btnGraph.className = 'px-2 py-0.5 text-xs rounded text-gray-500 hover:text-gray-800';
                    viewList.classList.remove('hidden');
                    viewGraph.classList.add('hidden');
                } else {
                    btnList.className = 'px-2 py-0.5 text-xs rounded text-gray-500 hover:text-gray-800';
                    btnGraph.className = 'px-2 py-0.5 text-xs rounded bg-white shadow-sm font-bold text-gray-800 border border-gray-200';
                    viewList.classList.add('hidden');
                    viewGraph.classList.remove('hidden');
                }
            }

            // --- Widget P1-D: Data Quality Filter ---
            function filterDataQuality(type) {
                const tbody = document.getElementById('p1d-tbody');
                const rows = tbody.querySelectorAll('tr');
                const emptyState = document.getElementById('p1d-empty-state');
                const filterLabel = document.getElementById('p1d-current-filter');
                const tableContainer = tbody.parentElement; // table element

                // Reset View
                tableContainer.classList.remove('hidden');
                emptyState.classList.add('hidden');

                // Update Label
                const labelMap = {
                    'good': 'ËÆ∞ÂΩïÂÆåÊï¥ ¬∑ Êó†ÈúÄË°•ÂÖÖ',
                    'bad': 'ÊâÄÊúâÈóÆÈ¢ò (All Issues)',
                    'date': 'Áº∫Â∞ëÂèëË¥ßÊó•Êúü',
                    'qty': 'Êï∞Èáè‰∏ç‰∏ÄËá¥',
                    'logic': 'Êó∂Èó¥È°∫Â∫èÂºÇÂ∏∏',
                    'other': 'ÂÖ∂‰ªñÂ≠óÊÆµÁº∫Â§±'
                };
                filterLabel.textContent = `ÂΩìÂâçÁ≠õÈÄâ: ${labelMap[type] || type}`;

                if (type === 'good') {
                    tableContainer.classList.add('hidden');
                    emptyState.classList.remove('hidden');
                    return;
                }

                // Filter Rows
                let visibleCount = 0;
                rows.forEach(row => {
                    if (type === 'bad') {
                        row.classList.remove('hidden');
                        visibleCount++;
                    } else {
                        if (row.classList.contains(`row-issue-${type}`)) {
                            row.classList.remove('hidden');
                            visibleCount++;
                        } else {
                            row.classList.add('hidden');
                        }
                    }
                });
            }

            // --- Contract Table Tab Switching ---
            function switchContractTab(tab) {
                // Update Buttons
                ['reqs', 'fin', 'pkg', 'plan'].forEach(t => {
                    const btn = document.getElementById(`tab-ct-${t}`);
                    if (t === tab) {
                        btn.className = "px-3 py-1 rounded-md bg-white text-[#006064] shadow-sm transition-all font-bold";
                    } else {
                        btn.className = "px-3 py-1 rounded-md hover:bg-white/50 text-gray-500 transition-all font-normal";
                    }
                });

                // Update Columns (Header & Body)
                const allDynamicCols = document.querySelectorAll('.col-reqs, .col-fin, .col-pkg, .col-plan');
                allDynamicCols.forEach(el => el.classList.add('hidden'));

                const activeCols = document.querySelectorAll(`.col-${tab}`);
                activeCols.forEach(el => el.classList.remove('hidden'));
            }

            // --- Widget P1-C: Zombie View Logic ---
            function toggleZombieView(view) {
                const btnC = document.getElementById('btn-zombie-contracts');
                const btnI = document.getElementById('btn-zombie-inventory');
                const viewC = document.getElementById('view-zombie-contracts');
                const viewI = document.getElementById('view-zombie-inventory');

                if (view === 'contracts') {
                    btnC.className = 'px-3 py-1 text-xs rounded bg-white shadow-sm font-bold text-gray-800 border border-gray-200';
                    btnI.className = 'px-3 py-1 text-xs rounded text-gray-500 hover:text-gray-800';
                    viewC.classList.remove('hidden');
                    viewI.classList.add('hidden');
                } else {
                    btnC.className = 'px-3 py-1 text-xs rounded text-gray-500 hover:text-gray-800';
                    btnI.className = 'px-3 py-1 text-xs rounded bg-white shadow-sm font-bold text-gray-800 border border-gray-200';
                    viewC.classList.add('hidden');
                    viewI.classList.remove('hidden');
                }
            }

            // --- Charts Initialization ---
            document.addEventListener('DOMContentLoaded', () => {


                // --- Internationalization (i18n) ---
                const TRANSLATIONS = {
                    en: {
                        // Header
                        "header_title": "OraNutrition Internal Process & Client Insights Overview",
                        "header_update": "Last Update: 2024-11-28 09:00 AM",
                        "filter_time_q4": "üìÖ Range: This Quarter (Q4)",
                        "filter_brand_all": "Brand: All",
                        "filter_line_all": "Line: All",
                        "refresh_data": "Refresh Data",

                        // Part 1
                        "p1_title": "Part 1. Internal Exception Radar",
                        "p1_subtitle": "Click cards to filter details",
                        "kpi_lead_title": "Lead Time Breach",
                        "kpi_lead_sub": "Overall Cycle > Target",
                        "kpi_pay_title": "Payment Blocked",
                        "kpi_pay_sub": "Payment Process Blocked",
                        "kpi_mat_title": "Material Risk",
                        "kpi_mat_sub": "Material Prep Risk",
                        "kpi_data_title": "Data Issues",
                        "kpi_data_sub": "Data Records Incomplete",

                        // Widget P1-B
                        "p1b_title": "P1-B. Key Contracts Stage Overview",
                        "btn_list": "List",
                        "btn_graph": "Graph",
                        "Tab_all": "All",
                        "Tab_blocker": "Blockers",
                        "Tab_delay": "Severe Delay",
                        "th_contract": "Contract / Brand",
                        "th_stage": "Current Stage",
                        "th_delay": "Max Delay",
                        "th_status": "Status / Reason",
                        "th_time": "Time (Sign/Upd)",

                        // Widget P1-C
                        "p1c_title": "P1-C. Zombie Contracts & Inventory",
                        "btn_zombie_contracts": "Inactive Contracts",
                        "btn_zombie_inventory": "Stuck Inventory",

                        // Widget P1-D
                        "p1d_title": "Data Quality Completeness",

                        // Part 2
                        "p2_title": "Part 2. Lead Time Deep Dive",
                        "p2_subtitle": "Process Cycle vs Target",

                        // Part 3
                        "p3_title": "Part 3. Client & Capacity Radar",
                        "p3a_title": "3A. Client Risk Watch",
                        "p3b_title": "3B. Capacity Utilization",
                        "p3c_title": "3C. Brand Capacity Concentration",

                        // Contract Table
                        "ct_title": "Contract Table",
                        "ct_date_range": "2024-06-01 ~ 2024-08-31",
                        "ct_search": "Search contracts...",
                        "ct_import": "Import New",
                        "ct_filter_all": "All",
                        "ct_filter_pending": "Pending Scheduling",
                        "ct_filter_more": "More",
                        "ct_role_reqs": "Reqs",
                        "ct_role_fin": "Finance",
                        "ct_role_pkg": "Pkg",
                        "ct_role_plan": "Plan",
                        "ct_th_date": "Date",
                        "ct_th_no": "Contract No",
                        "ct_th_brand": "Brand",
                        "ct_th_prod": "Product",
                        "ct_th_spec": "Spec",
                        "ct_th_qty": "Qty",
                        "ct_th_status": "Status",
                        "ct_th_action": "Action",
                        "ct_status_new": "New Contract",
                        "ct_status_pending": "Pending Preparation",
                        "ct_status_ongoing": "Production<br>On-Going",
                        "ct_status_done": "Done",

                        // Contract Table - Dynamic Headers
                        "ct_role_reqs": "Reqs",
                        "ct_role_fin": "Finance",
                        "ct_role_pkg": "Pkg",
                        "ct_role_plan": "Plan",

                        "ct_th_reqs_gacc": "GACC",
                        "ct_th_reqs_code": "Coding",
                        "ct_th_reqs_ship": "Ship Mode",
                        "ct_th_reqs_label": "Label",
                        "ct_th_reqs_other": "Other",

                        "ct_th_fin_inv": "Invoice #",
                        "ct_th_fin_dep": "Deposit",
                        "ct_th_fin_pre": "Pre-Prod",
                        "ct_th_fin_bal": "Balance",

                        "ct_th_pkg_inv": "Invoice #",
                        "ct_th_pkg_dep": "Deposit",
                        "ct_th_pkg_dep": "Deposit", // Fix duplicate key in source if any but keeping safe
                        "ct_th_pkg_pre": "Pre-Prod",
                        "ct_th_pkg_bal": "Balance",

                        "ct_th_plan_mat": "Material Stock",
                        "ct_th_plan_sch": "Schedule Log",

                        // Status Status (Split Lines)
                        "ct_status_new_1": "New",
                        "ct_status_new_2": "Contract",
                        "ct_status_pending_1": "Pending",
                        "ct_status_pending_2": "Preparation",
                        "ct_status_ongoing_1": "Production",
                        "ct_status_ongoing_2": "On-Going",
                    }
                };

                function applyLocalization() {
                    const params = new URLSearchParams(window.location.search);
                    const lang = params.get('lang');

                    if (lang === 'en' && TRANSLATIONS.en) {
                        document.querySelectorAll('[data-i18n]').forEach(el => {
                            const key = el.getAttribute('data-i18n');
                            if (TRANSLATIONS.en[key]) {
                                // Check if it's an input/placeholder or text
                                if (el.tagName === 'INPUT' && el.getAttribute('placeholder')) {
                                    el.setAttribute('placeholder', TRANSLATIONS.en[key]);
                                } else {
                                    el.textContent = TRANSLATIONS.en[key];
                                }
                            }
                        });
                    }
                }

                function initCharts() {
                    // Register DataLabels plugin globally
                    Chart.register(ChartDataLabels);
                    Chart.defaults.set('plugins.datalabels', {
                        color: '#fff',
                        font: { weight: 'bold', size: 10 },
                        display: 'auto' // Only show if fits
                    });
                    Chart.defaults.font.family = "Inter, system-ui, sans-serif";

                    // 1E: Data Quality Donut (Good vs Bad)
                    new Chart(document.getElementById('dataQualityGoodBad'), {
                        type: 'doughnut',
                        data: {
                            labels: ['ÂÆåÊï¥ (Good)', 'Áº∫Â§± (Bad)'],
                            datasets: [{
                                data: [185, 15],
                                backgroundColor: ['#2A9D8F', '#E76F51'],
                                borderWidth: 0
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            cutout: '60%',
                            onClick: (e, activeElements) => {
                                if (activeElements.length > 0) {
                                    const index = activeElements[0].index;
                                    const type = index === 0 ? 'good' : 'bad';
                                    filterDataQuality(type);
                                }
                            },
                            plugins: {
                                legend: { display: false },
                                tooltip: { enabled: false },
                                datalabels: { display: false }
                            }
                        }
                    });

                    // 1E: Data Quality Donut (Issue Type)
                    // 1E: Data Quality Donut (Issue Type)
                    new Chart(document.getElementById('dataQualityChart'), {
                        type: 'doughnut',
                        data: {
                            labels: ['Áº∫Â∞ëÂèëË¥ßÊó•Êúü', 'Êï∞Èáè‰∏ç‰∏ÄËá¥', 'Êó∂Èó¥È°∫Â∫èÂºÇÂ∏∏', 'ÂÖ∂‰ªñÂ≠óÊÆµÁº∫Â§±'],
                            datasets: [{
                                data: [12, 3, 1, 1],
                                backgroundColor: ['#E76F51', '#F4A261', '#E9C46A', '#264653'],
                                borderWidth: 0
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            cutout: '50%',
                            layout: {
                                padding: 20 // Ensure space for outside labels
                            },
                            onClick: (e, activeElements) => {
                                if (activeElements.length > 0) {
                                    const index = activeElements[0].index;
                                    const types = ['date', 'qty', 'logic', 'other'];
                                    filterDataQuality(types[index]);
                                }
                            },
                            plugins: {
                                legend: { display: false },
                                datalabels: {
                                    display: true,
                                    color: '#666',
                                    anchor: 'end',
                                    align: 'end',
                                    offset: 10,
                                    font: { size: 10, weight: 'normal' },
                                    formatter: (value, ctx) => {
                                        return ctx.chart.data.labels[ctx.dataIndex];
                                    }
                                }
                            }
                        },
                        plugins: [{
                            id: 'outsideLine',
                            afterDraw: (chart) => {
                                const { ctx, chartArea: { width, height } } = chart;
                                ctx.save();

                                chart.data.datasets.forEach((dataset, i) => {
                                    const meta = chart.getDatasetMeta(i);
                                    meta.data.forEach((element, index) => {
                                        // Only draw if visible
                                        if (!element.hidden) {
                                            const { x, y } = element.tooltipPosition();
                                            const center = element.getCenterPoint();

                                            // Calculate outer point (approximate based on radius)
                                            // We can use the tooltip position as a start, and draw to the label position
                                            // But we don't know exact label position easily.
                                            // Let's draw a line from the outer arc to a fixed offset.

                                            const angle = element.startAngle + (element.endAngle - element.startAngle) / 2;
                                            const outerRadius = element.outerRadius;
                                            const lineLength = 10;

                                            const startX = center.x + Math.cos(angle) * outerRadius;
                                            const startY = center.y + Math.sin(angle) * outerRadius;

                                            const endX = center.x + Math.cos(angle) * (outerRadius + lineLength);
                                            const endY = center.y + Math.sin(angle) * (outerRadius + lineLength);

                                            ctx.beginPath();
                                            ctx.moveTo(startX, startY);
                                            ctx.lineTo(endX, endY);
                                            ctx.strokeStyle = '#999';
                                            ctx.lineWidth = 1;
                                            ctx.stroke();
                                        }
                                    });
                                });
                                ctx.restore();
                            }
                        }]
                    });

                    // 3A: Client Risk Bar
                    new Chart(document.getElementById('clientRiskChart'), {
                        type: 'bar',
                        data: {
                            labels: ['Vitality', 'Muscle'],
                            datasets: [
                                { label: '‰∏äÂ≠£Â∫¶ (Prev Q)', data: [60, 60], backgroundColor: '#E5E7EB', barPercentage: 0.6, datalabels: { color: '#666', anchor: 'end', align: 'top' } },
                                { label: 'Êú¨Â≠£Â∫¶ (Curr Q)', data: [5, 25], backgroundColor: ['#E76F51', '#F4A261'], barPercentage: 0.6, datalabels: { color: '#666', anchor: 'end', align: 'top' } }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { position: 'bottom', labels: { boxWidth: 10, font: { size: 10 } } },
                                tooltip: {
                                    callbacks: {
                                        afterBody: function (context) {
                                            const idx = context[0].dataIndex;
                                            const risk = idx === 0 ? 'Dormant (‰ºëÁú†)' : 'Cooling (ÈôçÊ∏©)';
                                            return `Risk: ${risk}\nPrev: 60k / 3 Contracts\nCurr: ${context[0].raw}k / 1 Contract`;
                                        }
                                    }
                                },
                                datalabels: { display: true }
                            },
                            scales: { y: { display: false, max: 80 }, x: { grid: { display: false } } }
                        }
                    });

                    // 3C: Capacity Bar
                    new Chart(document.getElementById('concentrationChart'), {
                        type: 'bar',
                        data: {
                            labels: ['Little Umbrella', 'PowerGums', 'ÂÖ∂‰ªñ (Others)'],
                            datasets: [{
                                data: [42, 30, 28],
                                backgroundColor: ['#2A9D8F', '#264653', '#E5E7EB'],
                                borderRadius: 4,
                                barPercentage: 0.5
                            }]
                        },
                        options: {
                            indexAxis: 'y',
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: { x: { display: false }, y: { grid: { display: false } } },
                            plugins: {
                                legend: { display: false },
                                datalabels: {
                                    anchor: 'end',
                                    align: 'end',
                                    color: '#666',
                                    formatter: (value) => value + '%'
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function (context) {
                                            return `${context.raw}% ‰ªΩÈ¢ù (${context.raw * 1000} Units)`;
                                        }
                                    }
                                }
                            }
                        }
                    });

                    // P1: Waterfall (Simulated with Floating Bars)
                    new Chart(document.getElementById('p1WaterfallChart'), {
                        type: 'bar',
                        data: {
                            labels: ['Ê¨æÈ°πÂà∞‰Ωç', 'Áâ©ÊñôÂ∞±Áª™', 'Á≠âÂæÖÊéí‰∫ß', 'Áîü‰∫ßÂà∂ÈÄ†', 'ÂèëË¥ß'],
                            datasets: [{
                                label: 'Èò∂ÊÆµËÄóÊó∂',
                                data: [
                                    [0, 5],    // Stage 1: 0-5
                                    [5, 15],   // Stage 2: 5-15 (10d)
                                    [15, 20],  // Stage 3: 15-20 (5d)
                                    [20, 35],  // Stage 4: 20-35 (15d)
                                    [35, 42]   // Stage 5: 35-42 (7d)
                                ],
                                backgroundColor: [
                                    '#2A9D8F', '#2A9D8F', '#E9C46A', '#264653', '#2A9D8F'
                                ],
                                borderRadius: 4,
                                barPercentage: 0.6
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false },
                                datalabels: {
                                    formatter: (value) => (value[1] - value[0]) + 'Â§©',
                                    color: '#fff',
                                    font: { weight: 'bold' }
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function (context) {
                                            const v = context.raw;
                                            return `ËÄóÊó∂: ${v[1] - v[0]} Â§©`;
                                        }
                                    }
                                }
                            },
                            scales: {
                                y: { beginAtZero: true, title: { display: true, text: 'Á¥ØËÆ°Â§©Êï∞ (Cumulative Days)' } }
                            }
                        }
                    });

                    // P2: Breach Rate
                    new Chart(document.getElementById('p2BreachChart'), {
                        type: 'bar',
                        data: {
                            labels: ['S1 Ê¨æÈ°π', 'S2 Áâ©Êñô', 'S3 Á≠âÂæÖ', 'S4 Áîü‰∫ß', 'S5 ÂèëË¥ß'],
                            datasets: [{
                                label: 'Ë∂ÖÊó∂ÊØî‰æã (Breach %)',
                                data: [10, 68, 20, 45, 5],
                                backgroundColor: [
                                    '#2A9D8F', // <20%
                                    '#E76F51', // >50% (Red)
                                    '#E9C46A', // 20-50% (Orange)
                                    '#E9C46A',
                                    '#2A9D8F'
                                ],
                                borderRadius: 4,
                                barPercentage: 0.6
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false },
                                datalabels: {
                                    formatter: (value) => value + '%',
                                    anchor: 'end',
                                    align: 'top',
                                    color: '#666'
                                }
                            },
                            scales: { y: { beginAtZero: true, max: 100 } }
                        }
                    });

                    // P3: Plan Adherence (Mixed)
                    new Chart(document.getElementById('p3AdherenceChart'), {
                        data: {
                            labels: ['ËΩØÁ≥ñ (Gummies)', 'Á≤âÂâÇ (Powder)', 'Ê∂≤‰Ωì (Liquids)', 'ËÉ∂Âõä (Capsules)'],
                            datasets: [
                                {
                                    type: 'bar',
                                    label: 'ÊåâÊó∂‰∫§‰ªòÁéá (Adherence %)',
                                    data: [95, 82, 60, 88],
                                    backgroundColor: '#264653',
                                    yAxisID: 'y',
                                    barPercentage: 0.5,
                                    borderRadius: 4,
                                    datalabels: {
                                        color: '#fff',
                                        formatter: (value) => value + '%'
                                    }
                                },
                                {
                                    type: 'line',
                                    label: 'Âπ≥ÂùáÂª∂Ëøü (Avg Delay Days)',
                                    data: [1, 4, 12, 2],
                                    borderColor: '#E76F51',
                                    borderWidth: 2,
                                    yAxisID: 'y1',
                                    tension: 0.4,
                                    datalabels: {
                                        align: 'top',
                                        color: '#E76F51',
                                        formatter: (value) => value + 'd'
                                    }
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { position: 'bottom', labels: { boxWidth: 10, font: { size: 10 } } }
                            },
                            scales: {
                                y: { beginAtZero: true, max: 100, position: 'left', title: { display: true, text: '‰∫§‰ªòÁéá (%)' } },
                                y1: { beginAtZero: true, position: 'right', grid: { drawOnChartArea: false }, title: { display: true, text: 'Âª∂ËøüÂ§©Êï∞ (Days)' } }
                            }
                        }
                    });

                    // P4: Material Readiness
                    new Chart(document.getElementById('p4MaterialChart'), {
                        type: 'doughnut',
                        data: {
                            labels: ['Â∞±Áª™/ÂÆâÂÖ®', 'Á≠âÂæÖ‰∏≠', 'È´òÈ£éÈô©'],
                            datasets: [{
                                data: [85, 10, 5],
                                backgroundColor: ['#2A9D8F', '#E9C46A', '#E76F51'],
                                borderWidth: 0
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            cutout: '75%',
                            plugins: {
                                legend: { display: false },
                                datalabels: { display: false }
                            }
                        }
                    });

                    // G1: Factory Growth (Mixed: Bar + Line)
                    new Chart(document.getElementById('g1GrowthChart'), {
                        data: {
                            labels: ['Q1 2024', 'Q2 2024', 'Q3 2024', 'Q4 2024 (Est)'],
                            datasets: [
                                {
                                    type: 'bar',
                                    label: 'Â≠£Â∫¶Âá∫Ë¥ßÈáè (Units)',
                                    data: [800000, 950000, 1050000, 1200000],
                                    backgroundColor: 'rgba(42, 157, 143, 0.6)',
                                    yAxisID: 'y',
                                    barPercentage: 0.5,
                                    borderRadius: 4,
                                    datalabels: {
                                        color: '#fff',
                                        formatter: (value) => (value / 10000) + '‰∏á'
                                    }
                                },
                                {
                                    type: 'line',
                                    label: 'Âπ≥Âùá‰∫§‰ªòÂë®Êúü (Days)',
                                    data: [48, 46, 45, 42],
                                    borderColor: '#264653',
                                    borderWidth: 2,
                                    yAxisID: 'y1',
                                    tension: 0.4,
                                    datalabels: {
                                        align: 'top',
                                        color: '#264653',
                                        formatter: (value) => value + 'd'
                                    }
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { position: 'bottom', labels: { boxWidth: 10, font: { size: 10 } } }
                            },
                            scales: {
                                y: { beginAtZero: true, position: 'left', title: { display: true, text: 'Âá∫Ë¥ßÈáè (Units)' } },
                                y1: { beginAtZero: false, min: 30, position: 'right', grid: { drawOnChartArea: false }, title: { display: true, text: 'Âë®Êúü (Days)' } }
                            }
                        }
                    }); // Close G1

                } // Close initCharts

                initCharts();
                applyLocalization();
            });
        </script>
</body>

</html>